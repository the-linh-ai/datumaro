<!doctype html>
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="generator" content="Hugo 0.83.1" /><link rel="canonical" type="text/html" href="../../../docs/formats/">
<META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">


<link rel="shortcut icon" href="../../../favicons/favicon.ico" >
<link rel="apple-touch-icon" href="../../../favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="../../../favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="../../../favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="../../../favicons/android-36x36.png" sizes="36x36">
<link rel="icon" type="image/png" href="../../../favicons/android-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="../../../favicons/android-72x72.png" sizes="72x72">
<link rel="icon" type="image/png" href="../../../favicons/android-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../../../favicons/android-144x144.png" sizes="144x144">
<link rel="icon" type="image/png" href="../../../favicons/android-192x192.png" sizes="192x192">

<title>Formats | Dataset Management Framework</title>
<meta name="description" content=""><meta property="og:title" content="Formats" />
<meta property="og:description" content="" />
<meta property="og:type" content="website" />
<meta property="og:url" content="/docs/formats/" /><meta property="og:site_name" content="Dataset Management Framework" />

<meta itemprop="name" content="Formats">
<meta itemprop="description" content=""><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Formats"/>
<meta name="twitter:description" content=""/>




<link rel="preload" href="../../../scss/main.min.7739044bd284ace8b77f1ace79422fd408a2224eb69c6b8d48ef94dde2a179d5.css" as="style">
<link href="../../../scss/main.min.7739044bd284ace8b77f1ace79422fd408a2224eb69c6b8d48ef94dde2a179d5.css" rel="stylesheet" integrity="">


<script
  src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"
  integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
  crossorigin="anonymous"></script>

<script
  src="https://unpkg.com/lunr@2.3.8/lunr.min.js"
  integrity="sha384-vRQ9bDyE0Wnu+lMfm57BlYLO0/XauFuKpVsZPs7KEDwYKktWi5+Kz3MP8++DFlRY"
  crossorigin="anonymous"></script>






<link rel="stylesheet" href="../../../css/prism.css"/>




  </head>
  <body class="td-section">
    <header>
      
<nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar">
  <a class="navbar-brand" href="../../../docs">
    <span class="navbar-logo"></span><span class="font-weight-bold">Dataset Management Framework</span>
  </a>
  <div class="td-navbar-nav-scroll ml-md-auto" id="main_navbar">
    <ul class="navbar-nav mt-2 mt-lg-0">
      
      
        <li class="nav-item mr-4 mb-2 mb-lg-0">
          
          
          
          
          
          
          <a class="nav-link" href="https://github.com/openvinotoolkit/datumaro"  ><i class='fab fa-github'></i><span>GitHub</span></a>
        </li>
      
        <li class="nav-item mr-4 mb-2 mb-lg-0" id="api">
          <a class="nav-link" href="../../../api">API documentation</a>
        </li>
      
        <li class="nav-item dropdown mr-4 d-lg-block">
          

<a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
  v0.1.11
</a>
<div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
  
    
      <a class="dropdown-item" href="../../../../docs/formats/">develop</a>
  
    
      <a class="dropdown-item" href="../../../../v0.1.11/docs/formats/">v0.1.11</a>
  
    
      <a class="dropdown-item" href="../../../../v0.2/docs/formats/">v0.2</a>
  
    
      <a class="dropdown-item" href="../../../../v0.2.1/docs/formats/">v0.2.1</a>
  
    
      <a class="dropdown-item" href="../../../../v0.2.2/docs/formats/">v0.2.2</a>
  
    
      <a class="dropdown-item" href="../../../../v0.2.3/docs/formats/">v0.2.3</a>
  
</div>

        </li>
      
      
    </ul>
  </div>
  <div class="navbar-nav d-none d-lg-block">



<input
  type="search"
  class="form-control td-search-input"
  placeholder="&#xf002; Search this site…"
  aria-label="Search this site…"
  autocomplete="off"
  
  data-offline-search-index-json-src="../../../offline-search-index.34baac9cd79acf0e17f6bc8829702639.json"
  data-offline-search-base-href="../../../"
  data-offline-search-max-results="10"
>

</div>
</nav>

    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <div class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none">
          </div>
          <div class="d-none d-xl-block col-xl-2 td-toc d-print-none">
          </div>
          <main class="col-12 col-md-9 col-xl-8 pl-md-5" role="main">
            




<div class="td-content">
<div class="pageinfo pageinfo-primary d-print-none">
<p>
This the multi-page printable view of this section.
<a href="#" onclick="print();return false;">Click here to print</a>.
</p><p>
<a href="../../../docs/formats/">Return to the regular view of this page</a>.
</p>
</div>



<h1 class="title">Formats</h1>





    <ul>
    
  
  
  
  

  
    
    
	
<li>1: <a href="#pg-1646a51944fb0a27e86b592702a3eda8">ADE20k (v2017)</a></li>


    
  
    
    
	
<li>2: <a href="#pg-22c9ec5acd736f4b76466752445697c5">ADE20k (v2020)</a></li>


    
  
    
    
	
<li>3: <a href="#pg-ddb50cccf6304e9bb85b1b9fb0369c48">CIFAR</a></li>


    
  
    
    
	
<li>4: <a href="#pg-b4837f6e880fb91ac1bc5f75998df382">Cityscapes</a></li>


    
  
    
    
	
<li>5: <a href="#pg-f3691abbbae7eae85ce83b256e5aec64">COCO</a></li>


    
  
    
    
	
<li>6: <a href="#pg-69397e43070456769c1b4fdb55f75baf">Image zip</a></li>


    
  
    
    
	
<li>7: <a href="#pg-bc1c599a20f4d5c48cfd2ed514e3f166">Velodyne Points / KITTI Raw 3D</a></li>


    
  
    
    
	
<li>8: <a href="#pg-342fda6e82df12e35a4cf02ae46d4bab">KITTI</a></li>


    
  
    
    
	
<li>9: <a href="#pg-a2db7ecd3bd406d8822366b9b33229dd">MNIST</a></li>


    
  
    
    
	
<li>10: <a href="#pg-f97053c70a29d6713d3412af07bcdcca">Open Images</a></li>


    
  
    
    
	
<li>11: <a href="#pg-db1d30fa5536c19aa2aa75b33dbf92ea">Pascal VOC</a></li>


    
  
    
    
	
<li>12: <a href="#pg-0c9b196a180c68b9b42be11ddc52c8bb">Supervisely Point Cloud</a></li>


    
  
    
    
	
<li>13: <a href="#pg-f638f1a110145e49bc81ee72961dd7ef">YOLO</a></li>


    
  

    </ul>


<div class="content">
      
</div>
</div>


  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="">
    
	<h1 id="pg-1646a51944fb0a27e86b592702a3eda8">1 - ADE20k (v2017)</h1>
    
	<h2 id="format-specification">Format specification</h2>
<ul>
<li>
<p>The original ADE20K 2017 dataset is available
<a href="https://www.kaggle.com/soumikrakshit/ade20k">here</a>.</p>
</li>
<li>
<p>Also the consistency set (for checking the annotation consistency)
is available <a href="https://groups.csail.mit.edu/vision/datasets/ADE20K/ADE20K_2017_05_30_consistency.zip">here</a>.</p>
</li>
</ul>
<p>Supported annotation types:</p>
<ul>
<li><code>Masks</code></li>
</ul>
<p>Supported annotation attributes:</p>
<ul>
<li><code>occluded</code> (boolean): whether the object is occluded by another object</li>
<li>other arbitrary boolean attributes, which can be specified
in the annotation file <code>&lt;image_name&gt;_atr.txt</code></li>
</ul>
<h2 id="load-ade20k-2017-dataset">Load ADE20K 2017 dataset</h2>
<p>There are two ways to create Datumaro project and add ADE20K to it:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum import --format ade20k2017 --input-path &lt;path/to/dataset&gt;
<span style="color:#8f5902;font-style:italic"># or</span>
datum create
datum add path -f ade20k2017 &lt;path/to/dataset&gt;
</code></pre></div><p>Also it is possible to load dataset using Python API:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">from</span> <span style="color:#000">datumaro.components.dataset</span> <span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">Dataset</span>

<span style="color:#000">ade20k_dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">import_from</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;&lt;path/to/dataset&gt;&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;ade20k2017&#39;</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><p>ADE20K dataset directory should have the following structure:</p>
<!--lint disable fenced-code-flag-->
<pre><code>dataset/
├── subset1/
│   └── super_label_1/
│       ├── img1.jpg
│       ├── img1_atr.txt
│       ├── img1_parts_1.png
│       ├── img1_seg.png
│       ├── img2.jpg
│       ├── img2_atr.txt
│       └── ...
└── subset2/
    ├── img3.jpg
    ├── img3_atr.txt
    ├── img3_parts_1.png
    ├── img3_parts_2.png
    ├── img4.jpg
    ├── img4_atr.txt
    ├── img4_seg.png
    └── ...
</code></pre><p>The mask images <code>&lt;image_name&gt;_seg.png</code> contain information about the object
class segmentation masks and also separates each class into instances.
The channels R and G encode the objects class masks.
The channel B encodes the instance object masks.</p>
<p>The mask images <code>&lt;image_name&gt;_parts_N.png</code> contain segmentation mask for parts
of objects, where N is a number indicating the level in the part hierarchy.</p>
<p>The annotation files <code>&lt;image_name&gt;_atr.txt</code> describing the content of each
image. Each line in the text file contains:</p>
<ul>
<li>column 1: instance number,</li>
<li>column 2: part level (0 for objects),</li>
<li>column 3: occluded (1 for true),</li>
<li>column 4: original raw name (might provide a more detailed categorization),</li>
<li>column 5: class name (parsed using wordnet),</li>
<li>column 6: double-quoted list of attributes, separated by commas.
Each column is separated by a <code>#</code>. See example of dataset
<a href="https://github.com/openvinotoolkit/datumaro/tree/develop/tests/assets/ade20k2017_dataset">here</a>.</li>
</ul>
<h2 id="export-to-other-formats">Export to other formats</h2>
<p>Datumaro can convert ADE20K into any other format <a href="../../../docs/user-manual/supported-formats/">Datumaro supports</a>.
To get the expected result, convert the dataset to a format
that supports segmentation masks.</p>
<p>There are a few ways to convert ADE20k 2017 to other dataset format using CLI:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum import -f ade20k2017 -i &lt;path/to/dataset&gt;
datum <span style="color:#204a87">export</span> -f coco -o ./save_dir -- --save-images
<span style="color:#8f5902;font-style:italic"># or</span>
datum convert -if ade20k2017 -i &lt;path/to/dataset&gt; -f coco -o ./save_dir <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    --save-images
</code></pre></div><p>Or using Python API</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">from</span> <span style="color:#000">datumaro.components.dataset</span> <span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">Dataset</span>

<span style="color:#000">dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">import_from</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;&lt;path/to/dataset&gt;&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;ade202017&#39;</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">export</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;save_dir&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;coco&#39;</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><h2 id="examples">Examples</h2>
<p>Examples of using this format from the code can be found in
<a href="https://github.com/openvinotoolkit/datumaro/blob/develop/tests/test_ade20k2017_format.py">the format tests</a></p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-22c9ec5acd736f4b76466752445697c5">2 - ADE20k (v2020)</h1>
    
	<h2 id="format-specification">Format specification</h2>
<p>The original ADE20K 2020 dataset is available
<a href="https://groups.csail.mit.edu/vision/datasets/ADE20K/">here</a>.</p>
<p>Also the consistency set (for checking the annotation consistency)
is available <a href="https://groups.csail.mit.edu/vision/datasets/ADE20K/ADE20K_2017_05_30_consistency.zip">here</a>.</p>
<p>Supported annotation types:</p>
<ul>
<li><code>Masks</code></li>
</ul>
<p>Supported annotation attributes:</p>
<ul>
<li><code>occluded</code> (boolean): whether the object is occluded by another object</li>
<li>other arbitrary boolean attributes, which can be specified
in the annotation file <code>&lt;image_name&gt;.json</code></li>
</ul>
<h2 id="load-ade20k-dataset">Load ADE20K dataset</h2>
<p>There are two ways to create Datumaro project and add ADE20K to it:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum import --format ade20k2020 --input-path &lt;path/to/dataset&gt;
<span style="color:#8f5902;font-style:italic"># or</span>
datum create
datum add path -f ade20k2020 &lt;path/to/dataset&gt;
</code></pre></div><p>Also it is possible to load dataset using Python API:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">from</span> <span style="color:#000">datumaro.components.dataset</span> <span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">Dataset</span>

<span style="color:#000">ade20k_dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">import_from</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;&lt;path/to/dataset&gt;&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;ade20k2020&#39;</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><p>ADE20K dataset directory should has the following structure:</p>
<!--lint disable fenced-code-flag-->
<pre><code>dataset/
├── subset1/
│   ├── img1/  # directory with instance masks for img1
│   |    ├── instance_001_img1.png
│   |    ├── instance_002_img1.png
│   |    └── ...
│   ├── img1.jpg
│   ├── img1.json
│   ├── img1_seg.png
│   ├── img1_parts_1.png
│   |
│   ├── img2/  # directory with instance masks for img2
│   |    ├── instance_001_img2.png
│   |    ├── instance_002_img2.png
│   |    └── ...
│   ├── img2.jpg
│   ├── img2.json
│   └── ...
│
└── subset2/
    ├── super_label_1/
    |   ├── img3/  # directory with instance masks for img3
    |   |    ├── instance_001_img3.png
    |   |    ├── instance_002_img3.png
    |   |    └── ...
    |   ├── img3.jpg
    |   ├── img3.json
    |   ├── img3_seg.png
    |   ├── img3_parts_1.png
    |   └── ...
    |
    ├── img4/  # directory with instance masks for img4
    |   ├── instance_001_img4.png
    |   ├── instance_002_img4.png
    |   └── ...
    ├── img4.jpg
    ├── img4.json
    ├── img4_seg.png
    └── ...
</code></pre><p>The mask images <code>&lt;image_name&gt;_seg.png</code> contain information about the object
class segmentation masks and also separates each class into instances.
The channels R and G encode the objects class masks.
The channel B encodes the instance object masks.</p>
<p>The mask images <code>&lt;image_name&gt;_parts_N.png</code> contain segmentation mask for
parts of objects, where N is a number indicating the level in the part
hierarchy.</p>
<p>The <code>&lt;image_name&gt;</code> directory contains instance masks for each
object in the image, these masks represent one-channel images,
each pixel of which indicates an affinity to a specific object.</p>
<p>The annotation files <code>&lt;image_name&gt;.json</code> describing the content of each image.
See our <a href="https://github.com/openvinotoolkit/datumaro/tree/develop/tests/assets/ade20k2020_dataset">tests asset</a>
for example of this file,
or check <a href="https://github.com/CSAILVision/ADE20K">ADE20K toolkit</a> for it.</p>
<h2 id="export-to-other-formats">Export to other formats</h2>
<p>Datumaro can convert ADE20K into any other format <a href="../../../docs/user-manual/supported-formats/">Datumaro supports</a>.
To get the expected result, convert the dataset to a format
that supports segmentation masks.</p>
<p>There are a few ways to convert ADE20k to other dataset format using CLI:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum import -f ade20k2020 -i &lt;path/to/dataset&gt;
datum <span style="color:#204a87">export</span> -f coco -o ./save_dir -- --save-images
<span style="color:#8f5902;font-style:italic"># or</span>
datum convert -if ade20k2020 -i &lt;path/to/dataset&gt; -f coco -o ./save_dir <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    --save-images
</code></pre></div><p>Or using Python API</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">from</span> <span style="color:#000">datumaro.components.dataset</span> <span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">Dataset</span>

<span style="color:#000">dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">import_from</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;&lt;path/to/dataset&gt;&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;ade20k2020&#39;</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">export</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;save_dir&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;voc&#39;</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><h2 id="examples">Examples</h2>
<p>Examples of using this format from the code can be found in
<a href="https://github.com/openvinotoolkit/datumaro/blob/develop/tests/test_ade20k2020_format.py">the format tests</a></p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-ddb50cccf6304e9bb85b1b9fb0369c48">3 - CIFAR</h1>
    
	<h2 id="format-specification">Format specification</h2>
<p>CIFAR format specification is available <a href="https://www.cs.toronto.edu/~kriz/cifar.html">here</a>.</p>
<p>Supported annotation types:</p>
<ul>
<li><code>Label</code></li>
</ul>
<p>Datumaro supports Python version CIFAR-10/100.
The difference between CIFAR-10 and CIFAR-100 is how labels are stored
in the meta files (<code>batches.meta</code> or <code>meta</code>) and in the annotation files.
The 100 classes in the CIFAR-100 are grouped into 20 superclasses. Each image
comes with a &ldquo;fine&rdquo; label (the class to which it belongs) and a &ldquo;coarse&rdquo; label
(the superclass to which it belongs). In CIFAR-10 there are no superclasses.</p>
<p>CIFAR formats contains 32 x 32 images. As an extension, Datumaro supports
reading and writing of arbitrary-sized images.</p>
<h2 id="load-cifar-dataset">Load CIFAR dataset</h2>
<p>The CIFAR dataset is available for free download:</p>
<ul>
<li><a href="https://www.cs.toronto.edu/~kriz/cifar-10-python.tar.gz">cifar-10-python.tar.gz</a>:
CIFAR-10 python version</li>
<li><a href="https://www.cs.toronto.edu/~kriz/cifar-100-python.tar.gz">cifar-100-python.tar.gz</a>:
CIFAR-100 python version</li>
</ul>
<p>There are two ways to create Datumaro project and add CIFAR dataset to it:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum import --format cifar --input-path &lt;path/to/dataset&gt;
<span style="color:#8f5902;font-style:italic"># or</span>
datum create
datum add path -f cifar &lt;path/to/dataset&gt;
</code></pre></div><p>It is possible to specify project name and project directory run
<code>datum create --help</code> for more information.</p>
<p>CIFAR-10 dataset directory should have the following structure:</p>
<!--lint disable fenced-code-flag-->
<pre><code>└─ Dataset/
    ├── batches.meta
    ├── &lt;subset_name1&gt;
    ├── &lt;subset_name2&gt;
    └── ...
</code></pre><p>CIFAR-100 dataset directory should have the following structure:</p>
<!--lint disable fenced-code-flag-->
<pre><code>└─ Dataset/
    ├── meta
    ├── &lt;subset_name1&gt;
    ├── &lt;subset_name2&gt;
    └── ...
</code></pre><p>Dataset files use <a href="https://docs.python.org/3/library/pickle.html">Pickle</a>
data format.</p>
<p>Meta files:</p>
<!--lint disable fenced-code-flag-->
<pre><code>CIFAR-10:
    num_cases_per_batch: 1000
    label_names: list of strings (['airplane', 'automobile', 'bird', ...])
    num_vis: 3072

CIFAR-100:
    fine_label_names: list of strings (['apple', 'aquarium_fish', ...])
    coarse_label_names: list of strings (['aquatic_mammals', 'fish', ...])
</code></pre><p>Annotation files:</p>
<!--lint disable fenced-code-flag-->
<pre><code>Common:
    'batch_label': 'training batch 1 of &lt;N&gt;'
    'data': numpy.ndarray of uint8, layout N x C x H x W
    'filenames': list of strings

    If images have non-default size (32x32) (Datumaro extension):
        'image_sizes': list of (H, W) tuples

CIFAR-10:
    'labels': list of strings

CIFAR-100:
    'fine_labels': list of integers
    'coarse_labels': list of integers
</code></pre><h2 id="export-to-other-formats">Export to other formats</h2>
<p>Datumaro can convert CIFAR dataset into any other format <a href="../../../docs/user-manual/supported-formats">Datumaro supports</a>.
To get the expected result, convert the dataset to formats
that support the classification task (e.g. MNIST, ImageNet, PascalVOC,
etc.) There are few ways to convert CIFAR dataset to other dataset format:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum project import -f cifar -i &lt;path/to/cifar&gt;
datum <span style="color:#204a87">export</span> -f imagenet -o &lt;path/to/output/dir&gt;
<span style="color:#8f5902;font-style:italic"># or</span>
datum convert -if cifar -i &lt;path/to/cifar&gt; -f imagenet -o &lt;path/to/output/dir&gt;
</code></pre></div><h2 id="export-to-cifar">Export to CIFAR</h2>
<p>There are few ways to convert dataset to CIFAR format:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#8f5902;font-style:italic"># export dataset into CIFAR format from existing project</span>
datum <span style="color:#204a87">export</span> -p &lt;path/to/project&gt; -f cifar -o &lt;path/to/export/dir&gt; <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    -- --save-images
<span style="color:#8f5902;font-style:italic"># converting to CIFAR format from other format</span>
datum convert -if imagenet -i &lt;path/to/imagenet/dataset&gt; <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    -f cifar -o &lt;path/to/export/dir&gt; -- --save-images
</code></pre></div><p>Extra options for export to CIFAR format:</p>
<ul>
<li><code>--save-images</code> allow to export dataset with saving images
(by default <code>False</code>);</li>
<li><code>--image-ext &lt;IMAGE_EXT&gt;</code> allow to specify image extension
for exporting dataset (by default <code>.png</code>).</li>
</ul>
<p>The format (CIFAR-10 or CIFAR-100) in which the dataset will be
exported depends on the presence of superclasses in the <code>LabelCategories</code>.</p>
<h2 id="examples">Examples</h2>
<p>Datumaro supports filtering, transformation, merging etc. for all formats
and for the CIFAR format in particular. Follow <a href="../../../docs/user-manual">user manual</a>
to get more information about these operations.</p>
<p>There are few examples of using Datumaro operations to solve
particular problems with CIFAR dataset:</p>
<h3 id="example-1-how-to-create-custom-cifar-like-dataset">Example 1. How to create custom CIFAR-like dataset</h3>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">from</span> <span style="color:#000">datumaro.components.dataset</span> <span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">Dataset</span>
<span style="color:#204a87;font-weight:bold">from</span> <span style="color:#000">datumaro.components.extractor</span> <span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">Label</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">DatasetItem</span>

<span style="color:#000">dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">from_iterable</span><span style="color:#000;font-weight:bold">([</span>
    <span style="color:#000">DatasetItem</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">id</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">image</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">np</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">ones</span><span style="color:#000;font-weight:bold">((</span><span style="color:#0000cf;font-weight:bold">32</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">32</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">3</span><span style="color:#000;font-weight:bold">)),</span>
        <span style="color:#000">annotations</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">Label</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">3</span><span style="color:#000;font-weight:bold">)]</span>
    <span style="color:#000;font-weight:bold">),</span>
    <span style="color:#000">DatasetItem</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">id</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">image</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">np</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">ones</span><span style="color:#000;font-weight:bold">((</span><span style="color:#0000cf;font-weight:bold">32</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">32</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">3</span><span style="color:#000;font-weight:bold">)),</span>
        <span style="color:#000">annotations</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">Label</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">8</span><span style="color:#000;font-weight:bold">)]</span>
    <span style="color:#000;font-weight:bold">)</span>
<span style="color:#000;font-weight:bold">],</span> <span style="color:#000">categories</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;airplane&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;automobile&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;bird&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;cat&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;deer&#39;</span><span style="color:#000;font-weight:bold">,</span>
               <span style="color:#4e9a06">&#39;dog&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;frog&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;horse&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;ship&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;truck&#39;</span><span style="color:#000;font-weight:bold">])</span>

<span style="color:#000">dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">export</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;./dataset&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">format</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;cifar&#39;</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><h3 id="example-2-how-to-filter-and-convert-cifar-dataset-to-imagenet">Example 2. How to filter and convert CIFAR dataset to ImageNet</h3>
<p>Convert CIFAR dataset to ImageNet format, keep only images with <code>dog</code> class
presented:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#8f5902;font-style:italic"># Download CIFAR-10 dataset:</span>
<span style="color:#8f5902;font-style:italic"># https://www.cs.toronto.edu/~kriz/cifar-10-python.tar.gz</span>
datum convert --input-format cifar --input-path &lt;path/to/cifar&gt; <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>              --output-format imagenet <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>              --filter <span style="color:#4e9a06">&#39;/item[annotation/label=&#34;dog&#34;]&#39;</span>
</code></pre></div><p>Examples of using this format from the code can be found in
<a href="https://github.com/openvinotoolkit/datumaro/blob/develop/tests/test_cifar_format.py">the format tests</a></p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-b4837f6e880fb91ac1bc5f75998df382">4 - Cityscapes</h1>
    
	<h2 id="format-specification">Format specification</h2>
<p>Cityscapes format overview is available <a href="https://www.cityscapes-dataset.com/dataset-overview/">here</a>.
Cityscapes format specification is available <a href="https://github.com/mcordts/cityscapesScripts#the-cityscapes-dataset">here</a>.</p>
<p>Supported annotation types:</p>
<ul>
<li><code>Masks</code></li>
</ul>
<p>Supported annotation attributes:</p>
<ul>
<li><code>is_crowd</code> (boolean). Specifies if the annotation label can
distinguish between different instances.
If <code>False</code>, the annotation <code>id</code> field encodes the instance id.</li>
</ul>
<h2 id="load-cityscapes-dataset">Load Cityscapes dataset</h2>
<p>The Cityscapes dataset is available for free <a href="https://www.cityscapes-dataset.com/downloads/">download</a>.</p>
<p>There are two ways to create Datumaro project and add Cityscapes dataset to it:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum import --format cityscapes --input-path &lt;path/to/dataset&gt;
<span style="color:#8f5902;font-style:italic"># or</span>
datum create
datum add path -f cityscapes &lt;path/to/dataset&gt;
</code></pre></div><p>It is possible to specify project name and project directory run
<code>datum create --help</code> for more information.</p>
<p>Cityscapes dataset directory should have the following structure:</p>
<!--lint disable fenced-code-flag-->
<pre><code>└─ Dataset/
    ├── imgsFine/
    │   ├── leftImg8bit
    │   │   ├── &lt;split: train,val, ...&gt;
    │   │   |   ├── {city1}
    │   │   │   |   ├── {city1}_{seq:[0...6]}_{frame:[0...6]}_leftImg8bit.png
    │   │   │   │   └── ...
    │   │   |   ├── {city2}
    │   │   │   └── ...
    │   │   └── ...
    └── gtFine/
        ├── &lt;split: train,val, ...&gt;
        │   ├── {city1}
        │   |   ├── {city1}_{seq:[0...6]}_{frame:[0...6]}_gtFine_color.png
        │   |   ├── {city1}_{seq:[0...6]}_{frame:[0...6]}_gtFine_instanceIds.png
        │   |   ├── {city1}_{seq:[0...6]}_{frame:[0...6]}_gtFine_labelIds.png
        │   │   └── ...
        │   ├── {city2}
        │   └── ...
        └── ...
</code></pre><p>Annotated files description:</p>
<ol>
<li><code>*_leftImg8bit.png</code> - left images in 8-bit LDR format</li>
<li><code>*_color.png</code> - class labels encoded by its color</li>
<li><code>*_labelIds.png</code> - class labels are encoded by its index</li>
<li><code>*_instanceIds.png</code> - class and instance labels encoded by an instance ID.
The pixel values encode class and the individual instance: the integer part
of a division by 1000 of each ID provides class ID, the remainder
is the instance ID. If a certain annotation describes multiple instances,
then the pixels have the regular ID of that class</li>
</ol>
<p>To make sure that the selected dataset has been added to the project, you can
run <code>datum info</code>, which will display the project and dataset information.</p>
<h2 id="export-to-other-formats">Export to other formats</h2>
<p>Datumaro can convert Cityscapes dataset into any other format <a href="../../../docs/user-manual/supported-formats/">Datumaro supports</a>.
To get the expected result, convert the dataset to formats
that support the segmentation task (e.g. PascalVOC, CamVID, etc.)
There are few ways to convert Cityscapes dataset to other dataset format:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum project import -f cityscapes -i &lt;path/to/cityscapes&gt;
datum <span style="color:#204a87">export</span> -f voc -o &lt;path/to/output/dir&gt;
<span style="color:#8f5902;font-style:italic"># or</span>
datum convert -if cityscapes -i &lt;path/to/cityscapes&gt; -f voc -o &lt;path/to/output/dir&gt;
</code></pre></div><p>Some formats provide extra options for conversion.
These options are passed after double dash (<code>--</code>) in the command line.
To get information about them, run</p>
<p><code>datum export -f &lt;FORMAT&gt; -- -h</code></p>
<h2 id="export-to-cityscapes">Export to Cityscapes</h2>
<p>There are few ways to convert dataset to Cityscapes format:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#8f5902;font-style:italic"># export dataset into Cityscapes format from existing project</span>
datum <span style="color:#204a87">export</span> -p &lt;path/to/project&gt; -f cityscapes -o &lt;path/to/export/dir&gt; <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    -- --save-images
<span style="color:#8f5902;font-style:italic"># converting to Cityscapes format from other format</span>
datum convert -if voc -i &lt;path/to/voc/dataset&gt; <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    -f cityscapes -o &lt;path/to/export/dir&gt; -- --save-images
</code></pre></div><p>Extra options for export to cityscapes format:</p>
<ul>
<li><code>--save-images</code> allow to export dataset with saving images
(by default <code>False</code>);</li>
<li><code>--image-ext IMAGE_EXT</code> allow to specify image extension
for exporting dataset (by default - keep original or use <code>.png</code>, if none).</li>
<li><code>--label_map</code> allow to define a custom colormap. Example</li>
</ul>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#8f5902;font-style:italic"># mycolormap.txt :</span>
<span style="color:#8f5902;font-style:italic"># 0 0 255 sky</span>
<span style="color:#8f5902;font-style:italic"># 255 0 0 person</span>
<span style="color:#8f5902;font-style:italic">#...</span>
datum <span style="color:#204a87">export</span> -f cityscapes -- --label-map mycolormap.txt

<span style="color:#8f5902;font-style:italic"># or you can use original cityscapes colomap:</span>
datum <span style="color:#204a87">export</span> -f cityscapes -- --label-map cityscapes
</code></pre></div><h2 id="examples">Examples</h2>
<p>Datumaro supports filtering, transformation, merging etc. for all formats
and for the Cityscapes format in particular. Follow
<a href="../../../docs/user-manual/">user manual</a>
to get more information about these operations.</p>
<p>There are few examples of using Datumaro operations to solve
particular problems with Cityscapes dataset:</p>
<h3 id="example-1-load-the-original-cityscapes-dataset-and-convert-to-pascal-voc">Example 1. Load the original Cityscapes dataset and convert to Pascal VOC</h3>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create -o project
datum add path -p project -f cityscapes ./Cityscapes/
datum stats -p project
datum <span style="color:#204a87">export</span> -p final_project -o dataset -f voc -- --save-images
</code></pre></div><h3 id="example-2-create-a-custom-cityscapes-like-dataset">Example 2. Create a custom Cityscapes-like dataset</h3>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">numpy</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">np</span>
<span style="color:#204a87;font-weight:bold">from</span> <span style="color:#000">datumaro.components.dataset</span> <span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">Dataset</span>
<span style="color:#204a87;font-weight:bold">from</span> <span style="color:#000">datumaro.components.extractor</span> <span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">Mask</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">DatasetItem</span>

<span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">datumaro.plugins.cityscapes_format</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">Cityscapes</span>

<span style="color:#000">label_map</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">OrderedDict</span><span style="color:#000;font-weight:bold">()</span>
<span style="color:#000">label_map</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;background&#39;</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">label_map</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;label_1&#39;</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">3</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">label_map</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;label_2&#39;</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">3</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">categories</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">Cityscapes</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">make_cityscapes_categories</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">label_map</span><span style="color:#000;font-weight:bold">)</span>

<span style="color:#000">dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">from_iterable</span><span style="color:#000;font-weight:bold">([</span>
    <span style="color:#000">DatasetItem</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">id</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span>
        <span style="color:#000">image</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">np</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">ones</span><span style="color:#000;font-weight:bold">((</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">5</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">3</span><span style="color:#000;font-weight:bold">)),</span>
        <span style="color:#000">annotations</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">[</span>
            <span style="color:#000">Mask</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">image</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">np</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">array</span><span style="color:#000;font-weight:bold">([[</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">]]),</span> <span style="color:#000">label</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">),</span>
            <span style="color:#000">Mask</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">image</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">np</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">array</span><span style="color:#000;font-weight:bold">([[</span><span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">]]),</span> <span style="color:#000">label</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">id</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">,</span>
                <span style="color:#000">attributes</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">{</span><span style="color:#4e9a06">&#39;is_crowd&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#3465a4">False</span><span style="color:#000;font-weight:bold">}),</span>
        <span style="color:#000;font-weight:bold">]</span>
    <span style="color:#000;font-weight:bold">),</span>
<span style="color:#000;font-weight:bold">],</span> <span style="color:#000">categories</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">categories</span><span style="color:#000;font-weight:bold">)</span>

<span style="color:#000">dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">export</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;./dataset&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">format</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;cityscapes&#39;</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><p>Examples of using this format from the code can be found in
<a href="https://github.com/openvinotoolkit/datumaro/tree/develop/tests/test_cityscapes_format.py">the format tests</a></p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-f3691abbbae7eae85ce83b256e5aec64">5 - COCO</h1>
    
	<h2 id="format-specification">Format specification</h2>
<p>COCO format specification available <a href="https://cocodataset.org/#format-data">here</a>.</p>
<p>The dataset has annotations for multiple tasks. Each task has its own format
in Datumaro, and there is also a combined <code>coco</code> format, which includes all
the available tasks. The sub-formats have the same options as the &ldquo;main&rdquo;
format and only limit the set of annotation files they work with. To work with
multiple formats, use the corresponding option of the <code>coco</code> format.</p>
<p>Supported tasks / formats:</p>
<ul>
<li>The combined format - <code>coco</code></li>
<li><a href="https://cocodataset.org/#captions-2015">Image Captioning</a> - <code>coco_caption</code></li>
<li><a href="https://cocodataset.org/#detection-2020">Object Detection</a> - <code>coco_instances</code></li>
<li><a href="https://cocodataset.org/#panoptic-2020">Panoptic Segmentation</a> - <code>coco_panoptic</code></li>
<li><a href="https://cocodataset.org/#keypoints-2020">Keypoint Detection</a> - <code>coco_person_keypoints</code></li>
<li><a href="https://cocodataset.org/#stuff-2019">Stuff Segmentation</a> - <code>coco_stuff</code></li>
<li>Image Info - <code>coco_image_info</code></li>
<li>Image classification (Datumaro extension) - <code>coco_labels</code>. The format is like
Object Detection, but uses only <code>category_id</code> and <code>score</code> annotation fields.</li>
</ul>
<p>Supported annotation types (depending on the task):</p>
<ul>
<li><code>Caption</code> (captions)</li>
<li><code>Label</code> (label, Datumaro extension)</li>
<li><code>Bbox</code> (instances, person keypoints)</li>
<li><code>Polygon</code> (instances, person keypoints)</li>
<li><code>Mask</code> (instances, person keypoints, panoptic, stuff)</li>
<li><code>Points</code> (person keypoints)</li>
</ul>
<p>Supported annotation attributes:</p>
<ul>
<li><code>is_crowd</code> (boolean; on <code>bbox</code>, <code>polygon</code> and <code>mask</code> annotations) - Indicates
that the annotation covers multiple instances of the same class.</li>
<li><code>score</code> (number; range [0; 1]) - Indicates the confidence in this
annotation. Ground truth annotations always have 1.</li>
<li>arbitrary attributes (string/number) - A Datumaro extension. Stored
in the <code>attributes</code> section of the annotation descriptor.</li>
</ul>
<h2 id="load-coco-dataset">Load COCO dataset</h2>
<p>The COCO dataset is available for free download:</p>
<p>Images:</p>
<ul>
<li><a href="http://images.cocodataset.org/zips/train2017.zip">train images</a></li>
<li><a href="http://images.cocodataset.org/zips/val2017.zip">val images</a></li>
<li><a href="http://images.cocodataset.org/zips/test2017.zip">test images</a></li>
<li><a href="http://images.cocodataset.org/zips/unlabeled2017.zip">unlabeled images</a></li>
</ul>
<p>Annotations:</p>
<ul>
<li><a href="http://images.cocodataset.org/annotations/annotations_trainval2017.zip">captions</a></li>
<li><a href="http://images.cocodataset.org/annotations/image_info_test2017.zip">image_info</a></li>
<li><a href="http://images.cocodataset.org/annotations/annotations_trainval2017.zip">instances</a></li>
<li><a href="http://images.cocodataset.org/annotations/panoptic_annotations_trainval2017.zip">panoptic</a></li>
<li><a href="http://images.cocodataset.org/annotations/annotations_trainval2017.zip">person_keypoints</a></li>
<li><a href="http://images.cocodataset.org/annotations/stuff_annotations_trainval2017.zip">stuff</a></li>
</ul>
<p>There are two ways to create Datumaro project and add COCO dataset to it:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum import --format coco --input-path &lt;path/to/dataset&gt;
<span style="color:#8f5902;font-style:italic"># or</span>
datum create
datum add path -f coco &lt;path/to/dataset&gt;
</code></pre></div><p>It is possible to specify project name and project directory, run
<code>datum create --help</code> for more information.</p>
<p>A COCO dataset directory should have the following layout:</p>
<!--lint disable fenced-code-flag-->
<pre><code>└─ Dataset/
    ├── images/
    │   ├── train&lt;year&gt;/
    │   │   ├── &lt;image_name1.ext&gt;
    │   │   ├── &lt;image_name2.ext&gt;
    │   │   └── ...
    │   └── val&lt;year&gt;/
    │       ├── &lt;image_name1.ext&gt;
    │       ├── &lt;image_name2.ext&gt;
    │       └── ...
    └── annotations/
        ├── &lt;task&gt;_&lt;subset_name&gt;&lt;year&gt;.json
        └── ...
</code></pre><p>For the panoptic task, a dataset directory should have the following layout:</p>
<!--lint disable fenced-code-flag-->
<pre><code>└─ Dataset/
    ├── images/
    │   ├── train&lt;year&gt;
    │   │   ├── &lt;image_name1.ext&gt;
    │   │   ├── &lt;image_name2.ext&gt;
    │   │   └── ...
    │   ├── val&lt;year&gt;
    │   │   ├── &lt;image_name1.ext&gt;
    │   │   ├── &lt;image_name2.ext&gt;
    │   │   └── ...
    └── annotations/
        ├── panoptic_train&lt;year&gt;/
        │   ├── &lt;image_name1.ext&gt;
        │   ├── &lt;image_name2.ext&gt;
        │   └── ...
        ├── panoptic_train&lt;year&gt;.json
        ├── panoptic_val&lt;year&gt;/
        │   ├── &lt;image_name1.ext&gt;
        │   ├── &lt;image_name2.ext&gt;
        │   └── ...
        └── panoptic_val&lt;year&gt;.json
</code></pre><p>Annotation files must have the names like <code>&lt;task&gt;_&lt;subset_name&gt;&lt;year&gt;.json</code>.</p>
<p>You can import dataset for one or few tasks
instead of the whole dataset. This option also allows to import annotation
files with non-default names. For example:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum import --format coco_stuff --input-path &lt;path/to/stuff.json&gt;
</code></pre></div><p>To make sure that the selected dataset has been added to the project, you can
run <code>datum info</code>, which will display the project and dataset information.</p>
<p>Notes:</p>
<ul>
<li>COCO categories can have any integer ids, however, Datumaro will count
annotation category id 0 as &ldquo;not specified&rdquo;. This does not contradict
the original annotations, because they have category indices starting from 1.</li>
</ul>
<h2 id="export-to-other-formats">Export to other formats</h2>
<p>Datumaro can convert COCO dataset into any other format <a href="../../../docs/user-manual/supported-formats/">Datumaro supports</a>.
To get the expected result, convert the dataset to formats
that support the specified task (e.g. for panoptic segmentation - VOC, CamVID)
There are few ways to convert COCO dataset to other dataset format:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum project import -f coco -i &lt;path/to/coco&gt;
datum <span style="color:#204a87">export</span> -f voc -o &lt;path/to/output/dir&gt;
<span style="color:#8f5902;font-style:italic"># or</span>
datum convert -if coco -i &lt;path/to/coco&gt; -f voc -o &lt;path/to/output/dir&gt;
</code></pre></div><p>Some formats provide extra options for conversion.
These options are passed after double dash (<code>--</code>) in the command line.
To get information about them, run</p>
<p><code>datum export -f &lt;FORMAT&gt; -- -h</code></p>
<h2 id="export-to-coco">Export to COCO</h2>
<p>There are few ways to convert dataset to COCO format:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#8f5902;font-style:italic"># export dataset into COCO format from existing project</span>
datum <span style="color:#204a87">export</span> -p &lt;path/to/project&gt; -f coco -o &lt;path/to/export/dir&gt; <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    -- --save-images
<span style="color:#8f5902;font-style:italic"># converting to COCO format from other format</span>
datum convert -if voc -i &lt;path/to/voc/dataset&gt; <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    -f coco -o &lt;path/to/export/dir&gt; -- --save-images
</code></pre></div><p>Extra options for export to COCO format:</p>
<ul>
<li><code>--save-images</code> allow to export dataset with saving images
(by default <code>False</code>);</li>
<li><code>--image-ext IMAGE_EXT</code> allow to specify image extension
for exporting dataset (by default - keep original or use <code>.jpg</code>, if none);</li>
<li><code>--segmentation-mode MODE</code> allow to specify save mode for instance
segmentation:
<ul>
<li>&lsquo;guess&rsquo;: guess the mode for each instance
(using &lsquo;is_crowd&rsquo; attribute as hint)</li>
<li>&lsquo;polygons&rsquo;: save polygons( merge and convert masks, prefer polygons)</li>
<li>&lsquo;mask&rsquo;: save masks (merge and convert polygons, prefer masks)
(by default <code>guess</code>);</li>
</ul>
</li>
<li><code>--crop-covered</code> allow to crop covered segments so that background objects
segmentation was more accurate (by default <code>False</code>);</li>
<li><code>--allow-attributes ALLOW_ATTRIBUTES</code> allow export of attributes
(by default <code>True</code>);</li>
<li><code>--reindex REINDEX</code> allow to assign new indices to images and annotations,
useful to avoid merge conflicts (by default <code>False</code>);</li>
<li><code>--merge-images</code> allow to save all images into a single directory
(by default <code>False</code>);</li>
<li><code>--tasks TASKS</code> allow to specify tasks for export dataset,
by default Datumaro uses all tasks. Example:</li>
</ul>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum import -o project -f coco -i &lt;dataset&gt;
datum <span style="color:#204a87">export</span> -p project -f coco -- --tasks instances,stuff
</code></pre></div><h2 id="examples">Examples</h2>
<p>Datumaro supports filtering, transformation, merging etc. for all formats
and for the COCO format in particular. Follow
<a href="../../../docs/user-manual/">user manual</a>
to get more information about these operations.</p>
<p>There are few examples of using Datumaro operations to solve
particular problems with COCO dataset:</p>
<h3 id="example-1-how-to-load-an-original-panoptic-coco-dataset-and-convert-to-pascal-voc">Example 1. How to load an original panoptic COCO dataset and convert to Pascal VOC</h3>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create -o project
datum add path -p project -f coco_panoptic ./COCO/annotations/panoptic_val2017.json
datum stats -p project
datum <span style="color:#204a87">export</span> -p final_project -o dataset -f voc  --overwrite  -- --save-images
</code></pre></div><h3 id="example-2-how-to-create-custom-coco-like-dataset">Example 2. How to create custom COCO-like dataset</h3>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">numpy</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">np</span>
<span style="color:#204a87;font-weight:bold">from</span> <span style="color:#000">datumaro.components.dataset</span> <span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">Dataset</span>
<span style="color:#204a87;font-weight:bold">from</span> <span style="color:#000">datumaro.components.extractor</span> <span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">Mask</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">DatasetItem</span>

<span style="color:#000">dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">from_iterable</span><span style="color:#000;font-weight:bold">([</span>
    <span style="color:#000">DatasetItem</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">id</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;000000000001&#39;</span><span style="color:#000;font-weight:bold">,</span>
                <span style="color:#000">image</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">np</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">ones</span><span style="color:#000;font-weight:bold">((</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">5</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">3</span><span style="color:#000;font-weight:bold">)),</span>
                <span style="color:#000">subset</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;val&#39;</span><span style="color:#000;font-weight:bold">,</span>
                <span style="color:#000">attributes</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">{</span><span style="color:#4e9a06">&#39;id&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">40</span><span style="color:#000;font-weight:bold">},</span>
                <span style="color:#000">annotations</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">[</span>
                    <span style="color:#000">Mask</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">image</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">np</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">array</span><span style="color:#000;font-weight:bold">([[</span><span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">]]),</span> <span style="color:#000">label</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">3</span><span style="color:#000;font-weight:bold">,</span>
                        <span style="color:#204a87">id</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">7</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">group</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">7</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">attributes</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">{</span><span style="color:#4e9a06">&#39;is_crowd&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#3465a4">False</span><span style="color:#000;font-weight:bold">}),</span>
                    <span style="color:#000">Mask</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">image</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">np</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">array</span><span style="color:#000;font-weight:bold">([[</span><span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">]]),</span> <span style="color:#000">label</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span>
                        <span style="color:#204a87">id</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">20</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">group</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">20</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">attributes</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">{</span><span style="color:#4e9a06">&#39;is_crowd&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#3465a4">True</span><span style="color:#000;font-weight:bold">}),</span>
                <span style="color:#000;font-weight:bold">]</span>
            <span style="color:#000;font-weight:bold">),</span>
    <span style="color:#000;font-weight:bold">],</span> <span style="color:#000">categories</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;a&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;b&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;c&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;d&#39;</span><span style="color:#000;font-weight:bold">])</span>

<span style="color:#000">dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">export</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;./dataset&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">format</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;coco_panoptic&#39;</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><p>Examples of using this format from the code can be found in
<a href="https://github.com/openvinotoolkit/datumaro/tree/develop/tests/test_coco_format.py">the format tests</a></p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-69397e43070456769c1b4fdb55f75baf">6 - Image zip</h1>
    
	<h2 id="format-specification">Format specification</h2>
<p>The image zip format allow to export/import unannotated datasets
with images to/from zip archive. The format doesn&rsquo;t support any
annotations or attributes.</p>
<h2 id="load-image-zip-dataset">Load Image zip dataset</h2>
<p>Few ways to load unannotated datasets to your Datumaro project:</p>
<ul>
<li>From existing archive:</li>
</ul>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum import -o project -f image_zip -i ./images.zip
</code></pre></div><ul>
<li>From directory with zip archives. Datumaro will loaded images from
all zip files in the directory:</li>
</ul>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum import -o project -f image_zip -i ./foo
</code></pre></div><p>The directory with zip archives should have the following structure:</p>
<pre><code>└── foo/
    ├── archive1.zip/
    |   ├── image_1.jpg
    |   ├── image_2.png
    |   ├── subdir/
    |   |   ├── image_3.jpg
    |   |   └── ...
    |   └── ...
    ├── archive2.zip/
    |   ├── image_101.jpg
    |   ├── image_102.jpg
    |   └── ...
    ...
</code></pre><p>Images in a archives should have supported extension,
follow the <a href="../../../docs/user-manual/data-formats/">user manual</a> to see the supported
extensions.</p>
<h2 id="export-to-other-formats">Export to other formats</h2>
<p>Datumaro can load dataset images from a zip archive and convert it to
<a href="../../../docs/user-manual/supported-formats">another supported dataset format</a>,
for example:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum import -o project -f image_zip -i ./images.zip
datum <span style="color:#204a87">export</span> -f coco -o ./new_dir -- --save-images
</code></pre></div><h2 id="export-unannotated-dataset-to-zip-archive">Export unannotated dataset to zip archive</h2>
<p>Example: exporting images from VOC dataset to zip archives:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum import -o project -f voc -i ./VOC2012
datum <span style="color:#204a87">export</span> -f image_zip -o ./ --overwrite -- --name voc_images.zip <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    --compression ZIP_DEFLATED
</code></pre></div><p>Extra options for export to image_zip format:</p>
<ul>
<li><code>--save-images</code> allow to export dataset with saving images
(default: <code>False</code>);</li>
<li><code>--image-ext &lt;IMAGE_EXT&gt;</code> allow to specify image extension
for exporting dataset (default: use original or <code>.jpg</code>, if none);</li>
<li><code>--name</code> name of output zipfile (default: <code>default.zip</code>);</li>
<li><code>--compression</code> allow to specify archive compression method.
Available methods:
<code>ZIP_STORED</code>, <code>ZIP_DEFLATED</code>, <code>ZIP_BZIP2</code>, <code>ZIP_LZMA</code> (default: <code>ZIP_STORED</code>).
Follow <a href="https://pkware.cachefly.net/webdocs/casestudies/APPNOTE.TXT">zip documentation</a>
for more information.</li>
</ul>
<h2 id="examples">Examples</h2>
<p>Examples of using this format from the code can be found in
<a href="https://github.com/openvinotoolkit/datumaro/tree/develop/tests/test_image_zip_format.py">the format tests</a></p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-bc1c599a20f4d5c48cfd2ed514e3f166">7 - Velodyne Points / KITTI Raw 3D</h1>
    
	<h2 id="format-specification">Format specification</h2>
<p>Velodyne Points / KITTI Raw 3D data format:</p>
<ul>
<li><a href="http://www.cvlibs.net/datasets/kitti/raw_data.php">home page</a>.</li>
<li><a href="https://s3.eu-central-1.amazonaws.com/avg-kitti/devkit_raw_data.zip">specification</a></li>
</ul>
<p>Supported annotation types:</p>
<ul>
<li><code>Cuboid3d</code> (represent tracks)</li>
</ul>
<p>Supported annotation attributes:</p>
<ul>
<li><code>truncation</code> (write, string), possible values: <code>truncation_unset</code>,
<code>in_image</code>, <code>truncated</code>, <code>out_image</code>, <code>behind_image</code> (case-independent).</li>
<li><code>occlusion</code> (write, string), possible values: <code>occlusion_unset</code>, <code>visible</code>,
<code>partly</code>, <code>fully</code> (case-independent). This attribute has priority
over <code>occluded</code>.</li>
<li><code>occluded</code> (read/write, boolean)</li>
<li><code>keyframe</code> (read/write, boolean). Responsible for <code>occlusion_kf</code> field.</li>
<li><code>track_id</code> (read/write, integer). Indicates the group over frames for
annotations, represent tracks.</li>
</ul>
<p>Supported image attributes:</p>
<ul>
<li><code>frame</code> (read/write, integer). Indicates frame number of the image.</li>
</ul>
<h2 id="import-kitti-raw-dataset">Import KITTI Raw dataset</h2>
<p>The velodyne points/KITTI Raw dataset is available for downloading
<a href="http://www.cvlibs.net/datasets/kitti/raw_data.php">here</a> and
<a href="https://cloud.enterprise.deepsystems.io/s/YcyfIf5zrS7NZcI/download">here</a>.</p>
<p>KITTI Raw dataset directory should have the following structure:</p>
<!--lint disable fenced-code-flag-->
<pre><code>└─ Dataset/
    ├── image_00/ # optional, aligned images from different cameras
    │   └── data/
    │       ├── &lt;name1.ext&gt;
    │       └── &lt;name2.ext&gt;
    ├── image_01/
    │   └── data/
    │       ├── &lt;name1.ext&gt;
    │       └── &lt;name2.ext&gt;
    ...
    │
    ├── velodyne_points/ # optional, 3d point clouds
    │   └── data/
    │       ├── &lt;name1.pcd&gt;
    │       └── &lt;name2.pcd&gt;
    ├── tracklet_labels.xml
    └── frame_list.txt # optional, required for custom image names

</code></pre><p>The format does not support arbitrary image names and paths, but Datumaro
provides an option to use a special index file to allow this.</p>
<p><code>frame_list.txt</code> contents:</p>
<pre><code>12345 relative/path/to/name1/from/data
46 relative/path/to/name2/from/data
...
</code></pre><p>There are two ways to create Datumaro project and add KITTI dataset to it:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum import --format kitti_raw --input-path &lt;path/to/dataset&gt;
<span style="color:#8f5902;font-style:italic"># or</span>
datum create
datum add path -f kitti_raw &lt;path/to/dataset&gt;
</code></pre></div><p>To make sure that the selected dataset has been added to the project,
you can run <code>datum info</code>, which will display the project and dataset
information.</p>
<h2 id="export-to-other-formats">Export to other formats</h2>
<p>Datumaro can convert KITTI Raw dataset into any other
format <a href="../../../docs/user-manual/supported-formats/">Datumaro supports</a>.</p>
<p>Such conversion will only be successful if the output
format can represent the type of dataset you want to convert,
e.g. 3D point clouds can be saved in Supervisely Point Clouds format,
but not in COCO keypoints.</p>
<p>There are few ways to convert KITTI Raw dataset to other dataset format:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum import -f kitti_raw -i &lt;path/to/kitti_raw&gt; -o proj/
datum <span style="color:#204a87">export</span> -f sly_pointcloud -o &lt;path/to/output/dir&gt; -p proj/
<span style="color:#8f5902;font-style:italic"># or</span>
datum convert -if kitti_raw -i &lt;path/to/kitti_raw&gt; -f sly_pointcloud
</code></pre></div><p>Some formats provide extra options for conversion.
These options are passed after double dash (<code>--</code>) in the command line.
To get information about them, run</p>
<p><code>datum export -f &lt;FORMAT&gt; -- -h</code></p>
<h2 id="export-to-kitti-raw">Export to KITTI Raw</h2>
<p>There are few ways to convert dataset to KITTI Raw format:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#8f5902;font-style:italic"># export dataset into KITTI Raw format from existing project</span>
datum <span style="color:#204a87">export</span> -p &lt;path/to/project&gt; -f kitti_raw -o &lt;path/to/export/dir&gt; <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    -- --save-images
<span style="color:#8f5902;font-style:italic"># converting to KITTI Raw format from other format</span>
datum convert -if sly_pointcloud -i &lt;path/to/sly_pcd/dataset&gt; <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    -f kitti_raw -o &lt;path/to/export/dir&gt; -- --save-images --reindex
</code></pre></div><p>Extra options for exporting in KITTI Raw format:</p>
<ul>
<li><code>--save-images</code> allow to export dataset with saving images. This will
include point clouds and related images (by default <code>False</code>)</li>
<li><code>--image-ext IMAGE_EXT</code> allow to specify image extension
for exporting dataset (by default - keep original or use <code>.png</code>, if none)</li>
<li><code>--reindex</code> assigns new indices to frames and tracks. Allows annotations
without <code>track_id</code> attribute (they will be exported as single-frame tracks).</li>
<li><code>--allow-attrs</code> allows writing arbitrary annotation attributes. They will
be written in <code>&lt;annotations&gt;</code> section of <code>&lt;poses&gt;&lt;item&gt;</code>
(disabled by default)</li>
</ul>
<h2 id="examples">Examples</h2>
<h3 id="example-1-import-dataset-compute-statistics">Example 1. Import dataset, compute statistics</h3>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create -o project
datum add path -p project -f kitti_raw ../../kitti_raw/
datum stats -p project
</code></pre></div><h3 id="example-2-convert-supervisely-pointclouds-to-kitti-raw">Example 2. Convert Supervisely Pointclouds to KITTI Raw</h3>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum convert -if sly_pointcloud -i ../sly_pcd/ <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    -f kitti_raw -o my_kitti/ -- --save-images --allow-attrs
</code></pre></div><h3 id="example-3-create-a-custom-dataset">Example 3. Create a custom dataset</h3>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">from</span> <span style="color:#000">datumaro.components.dataset</span> <span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">Dataset</span>
<span style="color:#204a87;font-weight:bold">from</span> <span style="color:#000">datumaro.components.extractor</span> <span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">Cuboid3d</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">DatasetItem</span>

<span style="color:#000">dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">from_iterable</span><span style="color:#000;font-weight:bold">([</span>
    <span style="color:#000">DatasetItem</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">id</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;some/name/qq&#39;</span><span style="color:#000;font-weight:bold">,</span>
        <span style="color:#000">annotations</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">[</span>
            <span style="color:#000">Cuboid3d</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">position</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">13.54</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">-</span><span style="color:#0000cf;font-weight:bold">9.41</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0.24</span><span style="color:#000;font-weight:bold">],</span> <span style="color:#000">label</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span>
                <span style="color:#000">attributes</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">{</span><span style="color:#4e9a06">&#39;occluded&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#3465a4">False</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;track_id&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">}),</span>

            <span style="color:#000">Cuboid3d</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">position</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">3.4</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">-</span><span style="color:#0000cf;font-weight:bold">2.11</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">4.4</span><span style="color:#000;font-weight:bold">],</span> <span style="color:#000">label</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span>
                <span style="color:#000">attributes</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">{</span><span style="color:#4e9a06">&#39;occluded&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#3465a4">True</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;track_id&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">})</span>
        <span style="color:#000;font-weight:bold">],</span>
        <span style="color:#000">pcd</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;path/to/pcd1.pcd&#39;</span><span style="color:#000;font-weight:bold">,</span>
        <span style="color:#000">related_images</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">np</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">ones</span><span style="color:#000;font-weight:bold">((</span><span style="color:#0000cf;font-weight:bold">10</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">10</span><span style="color:#000;font-weight:bold">)),</span> <span style="color:#4e9a06">&#39;path/to/image2.png&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;image3.jpg&#39;</span><span style="color:#000;font-weight:bold">],</span>
        <span style="color:#000">attributes</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">{</span><span style="color:#4e9a06">&#39;frame&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">}</span>
    <span style="color:#000;font-weight:bold">),</span>
<span style="color:#000;font-weight:bold">],</span> <span style="color:#000">categories</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;cat&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;dog&#39;</span><span style="color:#000;font-weight:bold">])</span>

<span style="color:#000">dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">export</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;my_dataset/&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">format</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;kitti_raw&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">save_images</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#3465a4">True</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><p>Examples of using this format from the code can be found in
<a href="https://github.com/openvinotoolkit/datumaro/tree/develop/tests/test_kitti_raw_format.py">the format tests</a></p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-342fda6e82df12e35a4cf02ae46d4bab">8 - KITTI</h1>
    
	<h2 id="format-specification">Format specification</h2>
<p>The KITTI dataset has many annotations for different tasks. Datumaro supports
only few of them.</p>
<p>Supported tasks / formats:</p>
<ul>
<li><a href="http://www.cvlibs.net/datasets/kitti/eval_object.php?obj_benchmark">Object Detection</a> - <code>kitti_detection</code>
The format specification is available in <code>README.md</code> <a href="https://s3.eu-central-1.amazonaws.com/avg-kitti/devkit_object.zip">here</a>.</li>
<li><a href="http://www.cvlibs.net/datasets/kitti/eval_semseg.php?benchmark=semantics2015">Segmentation</a> - <code>kitti_segmentation</code>
The format specification is available in <code>README.md</code> <a href="https://s3.eu-central-1.amazonaws.com/avg-kitti/devkit_semantics.zip">here</a>.</li>
<li>Raw 3D / Velodyne Points - described <a href="../../../kitti_raw.md">here</a></li>
</ul>
<p>Supported annotation types:</p>
<ul>
<li><code>Bbox</code> (object detection)</li>
<li><code>Mask</code> (segmentation)</li>
</ul>
<p>Supported attributes:</p>
<ul>
<li><code>truncated</code> (boolean) - indicates that the bounding box specified for
the object does not correspond to the full extent of the object</li>
<li><code>occluded</code> (boolean) - indicates that a significant portion of the object
within the bounding box is occluded by another object</li>
</ul>
<h2 id="load-kitti-dataset">Load KITTI dataset</h2>
<p>The KITTI left color images for object detection are available <a href="http://www.cvlibs.net/download.php?file=data_object_image_2.zip">here</a>.
The KITTI object detection labels are available <a href="http://www.cvlibs.net/download.php?file=data_object_label_2.zip">here</a>.
The KITTI segmentation dataset is available <a href="http://www.cvlibs.net/download.php?file=data_semantics.zip">here</a>.</p>
<p>There are two ways to create Datumaro project and add KITTI dataset to it:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum import --format kitti --input-path &lt;path/to/dataset&gt;
<span style="color:#8f5902;font-style:italic"># or</span>
datum create
datum add path -f kitti &lt;path/to/dataset&gt;
</code></pre></div><p>It is possible to specify project name and project directory run
<code>datum create --help</code> for more information.</p>
<p>KITTI segmentation dataset directory should have the following structure:</p>
<!--lint disable fenced-code-flag-->
<pre><code>└─ Dataset/
    ├── testing/
    │   └── image_2/
    │       ├── &lt;name_1&gt;.&lt;img_ext&gt;
    │       ├── &lt;name_2&gt;.&lt;img_ext&gt;
    │       └── ...
    └── training/
        ├── image_2/ # left color camera images
        │   ├── &lt;name_1&gt;.&lt;img_ext&gt;
        │   ├── &lt;name_2&gt;.&lt;img_ext&gt;
        │   └── ...
        ├── label_2/ # left color camera label files
        │   ├── &lt;name_1&gt;.txt
        │   ├── &lt;name_2&gt;.txt
        │   └── ...
        ├── instance/ # instance segmentation masks
        │   ├── &lt;name_1&gt;.png
        │   ├── &lt;name_2&gt;.png
        │   └── ...
        ├── semantic/ # semantic segmentation masks (labels are encoded by its id)
        │   ├── &lt;name_1&gt;.png
        │   ├── &lt;name_2&gt;.png
        │   └── ...
        └── semantic_rgb/ # semantic segmentation masks (labels are encoded by its color)
            ├── &lt;name_1&gt;.png
            ├── &lt;name_2&gt;.png
            └── ...
</code></pre><p>You can import dataset for specific tasks
of KITTI dataset instead of the whole dataset,
for example:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum add path -f kitti_detection &lt;path/to/dataset&gt;
</code></pre></div><p>To make sure that the selected dataset has been added to the project, you can
run <code>datum info</code>, which will display the project and dataset information.</p>
<h2 id="export-to-other-formats">Export to other formats</h2>
<p>Datumaro can convert KITTI dataset into any other format <a href="../../../docs/user-manual/supported-formats/">Datumaro supports</a>.</p>
<p>Such conversion will only be successful if the output
format can represent the type of dataset you want to convert,
e.g. segmentation annotations can be
saved in <code>Cityscapes</code> format, but no as <code>COCO keypoints</code>.</p>
<p>There are few ways to convert KITTI dataset to other dataset format:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum project import -f kitti -i &lt;path/to/kitti&gt;
datum <span style="color:#204a87">export</span> -f cityscapes -o &lt;path/to/output/dir&gt;
<span style="color:#8f5902;font-style:italic"># or</span>
datum convert -if kitti -i &lt;path/to/kitti&gt; -f cityscapes -o &lt;path/to/output/dir&gt;
</code></pre></div><p>Some formats provide extra options for conversion.
These options are passed after double dash (<code>--</code>) in the command line.
To get information about them, run</p>
<p><code>datum export -f &lt;FORMAT&gt; -- -h</code></p>
<h2 id="export-to-kitti">Export to KITTI</h2>
<p>There are few ways to convert dataset to KITTI format:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#8f5902;font-style:italic"># export dataset into KITTI format from existing project</span>
datum <span style="color:#204a87">export</span> -p &lt;path/to/project&gt; -f kitti -o &lt;path/to/export/dir&gt; <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    -- --save-images
<span style="color:#8f5902;font-style:italic"># converting to KITTI format from other format</span>
datum convert -if cityscapes -i &lt;path/to/cityscapes/dataset&gt; <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    -f kitti -o &lt;path/to/export/dir&gt; -- --save-images
</code></pre></div><p>Extra options for export to KITTI format:</p>
<ul>
<li><code>--save-images</code> allow to export dataset with saving images
(by default <code>False</code>);</li>
<li><code>--image-ext IMAGE_EXT</code> allow to specify image extension
for exporting dataset (by default - keep original or use <code>.png</code>, if none).</li>
<li><code>--apply-colormap APPLY_COLORMAP</code> allow to use colormap for class masks
(in folder <code>semantic_rgb</code>, by default <code>True</code>);</li>
<li><code>--label_map</code> allow to define a custom colormap. Example</li>
</ul>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#8f5902;font-style:italic"># mycolormap.txt :</span>
<span style="color:#8f5902;font-style:italic"># 0 0 255 sky</span>
<span style="color:#8f5902;font-style:italic"># 255 0 0 person</span>
<span style="color:#8f5902;font-style:italic">#...</span>
datum <span style="color:#204a87">export</span> -f kitti -- --label-map mycolormap.txt

<span style="color:#8f5902;font-style:italic"># or you can use original kitti colomap:</span>
datum <span style="color:#204a87">export</span> -f kitti -- --label-map kitti
</code></pre></div><ul>
<li><code>--tasks TASKS</code> allow to specify tasks for export dataset,
by default Datumaro uses all tasks. Example:</li>
</ul>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum import -o project -f kitti -i &lt;dataset&gt;
datum <span style="color:#204a87">export</span> -p project -f kitti -- --tasks detection
</code></pre></div><ul>
<li><code>--allow-attributes ALLOW_ATTRIBUTES</code> allow export of attributes
(by default <code>True</code>).</li>
</ul>
<h2 id="examples">Examples</h2>
<p>Datumaro supports filtering, transformation, merging etc. for all formats
and for the KITTI format in particular. Follow
<a href="../../../docs/user-manual/">user manual</a>
to get more information about these operations.</p>
<p>There are few examples of using Datumaro operations to solve
particular problems with KITTI dataset:</p>
<h3 id="example-1-how-to-load-an-original-kitti-dataset-and-convert-to-cityscapes">Example 1. How to load an original KITTI dataset and convert to Cityscapes</h3>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create -o project
datum add path -p project -f kitti ./KITTI/
datum stats -p project
datum <span style="color:#204a87">export</span> -p final_project -o dataset -f cityscapes -- --save-images
</code></pre></div><h3 id="example-2-how-to-create-custom-kitti-like-dataset">Example 2. How to create custom KITTI-like dataset</h3>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">numpy</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">np</span>
<span style="color:#204a87;font-weight:bold">from</span> <span style="color:#000">datumaro.components.dataset</span> <span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">Dataset</span>
<span style="color:#204a87;font-weight:bold">from</span> <span style="color:#000">datumaro.components.extractor</span> <span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">Mask</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">DatasetItem</span>

<span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">datumaro.plugins.kitti_format</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">KITTI</span>

<span style="color:#000">label_map</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">{}</span>
<span style="color:#000">label_map</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;background&#39;</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">label_map</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;label_1&#39;</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">3</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">label_map</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;label_2&#39;</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">3</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">categories</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">KITTI</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">make_kitti_categories</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">label_map</span><span style="color:#000;font-weight:bold">)</span>

<span style="color:#000">dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">from_iterable</span><span style="color:#000;font-weight:bold">([</span>
    <span style="color:#000">DatasetItem</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">id</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span>
                <span style="color:#000">image</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">np</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">ones</span><span style="color:#000;font-weight:bold">((</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">5</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">3</span><span style="color:#000;font-weight:bold">)),</span>
                <span style="color:#000">annotations</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">[</span>
                    <span style="color:#000">Mask</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">image</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">np</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">array</span><span style="color:#000;font-weight:bold">([[</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">]]),</span> <span style="color:#000">label</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">id</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span>
                        <span style="color:#000">attributes</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">{</span><span style="color:#4e9a06">&#39;is_crowd&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#3465a4">False</span><span style="color:#000;font-weight:bold">}),</span>
                    <span style="color:#000">Mask</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">image</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">np</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">array</span><span style="color:#000;font-weight:bold">([[</span><span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">]]),</span> <span style="color:#000">label</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">id</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span>
                        <span style="color:#000">attributes</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">{</span><span style="color:#4e9a06">&#39;is_crowd&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#3465a4">False</span><span style="color:#000;font-weight:bold">}),</span>
                <span style="color:#000;font-weight:bold">]</span>
            <span style="color:#000;font-weight:bold">),</span>
    <span style="color:#000;font-weight:bold">],</span> <span style="color:#000">categories</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">categories</span><span style="color:#000;font-weight:bold">)</span>

<span style="color:#000">dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">export</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;./dataset&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">format</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;kitti&#39;</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><p>Examples of using this format from the code can be found in
<a href="https://github.com/openvinotoolkit/datumaro/tree/develop/tests/test_kitti_format.py">the format tests</a></p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-a2db7ecd3bd406d8822366b9b33229dd">9 - MNIST</h1>
    
	<h2 id="format-specification">Format specification</h2>
<p>MNIST format specification is available <a href="http://yann.lecun.com/exdb/mnist/">here</a>.
Fashion MNIST format specification is available <a href="https://github.com/zalandoresearch/fashion-mnist">here</a>.
MNIST in CSV  format specification is available <a href="https://pjreddie.com/projects/mnist-in-csv/">here</a>.</p>
<p>The dataset has few data formats available. Datumaro supports the
binary (Python pickle) format and the CSV variant. Each data format is covered
by a separate Datumaro format.</p>
<p>Supported formats:</p>
<ul>
<li>Binary (Python pickle) - <code>mnist</code></li>
<li>CSV - <code>mnist_csv</code></li>
</ul>
<p>Supported annotation types:</p>
<ul>
<li><code>Label</code></li>
</ul>
<p>The format only supports single channel 28 x 28 images.</p>
<h2 id="load-mnist-dataset">Load MNIST dataset</h2>
<p>The MNIST dataset is available for free download:</p>
<ul>
<li><a href="https://ossci-datasets.s3.amazonaws.com/mnist/train-images-idx3-ubyte.gz">train-images-idx3-ubyte.gz</a>:
training set images</li>
<li><a href="https://ossci-datasets.s3.amazonaws.com/mnist/train-labels-idx1-ubyte.gz">train-labels-idx1-ubyte.gz</a>:
training set labels</li>
<li><a href="https://ossci-datasets.s3.amazonaws.com/mnist/t10k-images-idx3-ubyte.gz">t10k-images-idx3-ubyte.gz</a>:
test set images</li>
<li><a href="https://ossci-datasets.s3.amazonaws.com/mnist/t10k-labels-idx1-ubyte.gz">t10k-labels-idx1-ubyte.gz</a>:
test set labels</li>
</ul>
<p>The Fashion MNIST dataset is available for free download:</p>
<ul>
<li><a href="http://fashion-mnist.s3-website.eu-central-1.amazonaws.com/train-images-idx3-ubyte.gz">train-images-idx3-ubyte.gz</a>:
training set images</li>
<li><a href="http://fashion-mnist.s3-website.eu-central-1.amazonaws.com/train-labels-idx1-ubyte.gz">train-labels-idx1-ubyte.gz</a>:
training set labels</li>
<li><a href="http://fashion-mnist.s3-website.eu-central-1.amazonaws.com/t10k-images-idx3-ubyte.gz">t10k-images-idx3-ubyte.gz</a>:
test set images</li>
<li><a href="http://fashion-mnist.s3-website.eu-central-1.amazonaws.com/t10k-labels-idx1-ubyte.gz">t10k-labels-idx1-ubyte.gz</a>:
test set labels</li>
</ul>
<p>The MNIST in CSV dataset is available for free download:</p>
<ul>
<li><a href="https://pjreddie.com/media/files/mnist_train.csv">mnist_train.csv</a></li>
<li><a href="https://pjreddie.com/media/files/mnist_test.csv">mnist_test.csv</a></li>
</ul>
<p>There are two ways to create Datumaro project and add MNIST dataset to it:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum import --format mnist --input-path &lt;path/to/dataset&gt;
<span style="color:#8f5902;font-style:italic"># or</span>
datum create
datum add path -f mnist &lt;path/to/dataset&gt;
</code></pre></div><p>There are two ways to create Datumaro project and add MNIST in CSV dataset
to it:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum import --format mnist_csv --input-path &lt;path/to/dataset&gt;
<span style="color:#8f5902;font-style:italic"># or</span>
datum create
datum add path -f mnist_csv &lt;path/to/dataset&gt;
</code></pre></div><p>It is possible to specify project name and project directory run
<code>datum create --help</code> for more information.</p>
<p>MNIST dataset directory should have the following structure:</p>
<!--lint disable fenced-code-flag-->
<pre><code>└─ Dataset/
    ├── labels.txt # list of non-digit labels (optional)
    ├── t10k-images-idx3-ubyte.gz
    ├── t10k-labels-idx1-ubyte.gz
    ├── train-images-idx3-ubyte.gz
    └── train-labels-idx1-ubyte.gz
</code></pre><p>MNIST in CSV dataset directory should have the following structure:</p>
<!--lint disable fenced-code-flag-->
<pre><code>└─ Dataset/
    ├── labels.txt # list of non-digit labels (optional)
    ├── mnist_test.csv
    └── mnist_train.csv
</code></pre><p>If the dataset needs non-digit labels, you need to add the <code>labels.txt</code>
to the dataset folder. For example, <code>labels.txt</code> for Fashion MNIST the
following contents:</p>
<!--lint disable fenced-code-flag-->
<pre><code>T-shirt/top
Trouser
Pullover
Dress
Coat
Sandal
Shirt
Sneaker
Bag
Ankle boot
</code></pre><h2 id="export-to-other-formats">Export to other formats</h2>
<p>Datumaro can convert MNIST dataset into any other format <a href="../../../docs/user-manual/supported-formats/">Datumaro supports</a>.
To get the expected result, convert the dataset to formats
that support the classification task (e.g. CIFAR-10/100, ImageNet, PascalVOC,
etc.) There are few ways to convert MNIST dataset to other dataset format:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum project import -f mnist -i &lt;path/to/mnist&gt;
datum <span style="color:#204a87">export</span> -f imagenet -o &lt;path/to/output/dir&gt;
<span style="color:#8f5902;font-style:italic"># or</span>
datum convert -if mnist -i &lt;path/to/mnist&gt; -f imagenet -o &lt;path/to/output/dir&gt;
</code></pre></div><p>These commands also work for MNIST in CSV if you use <code>mnist_csv</code> instead of <code>mnist</code>.</p>
<h2 id="export-to-mnist">Export to MNIST</h2>
<p>There are few ways to convert dataset to MNIST format:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#8f5902;font-style:italic"># export dataset into MNIST format from existing project</span>
datum <span style="color:#204a87">export</span> -p &lt;path/to/project&gt; -f mnist -o &lt;path/to/export/dir&gt; <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    -- --save-images
<span style="color:#8f5902;font-style:italic"># converting to MNIST format from other format</span>
datum convert -if imagenet -i &lt;path/to/imagenet/dataset&gt; <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    -f mnist -o &lt;path/to/export/dir&gt; -- --save-images
</code></pre></div><p>Extra options for export to MNIST format:</p>
<ul>
<li><code>--save-images</code> allow to export dataset with saving images
(by default <code>False</code>);</li>
<li><code>--image-ext &lt;IMAGE_EXT&gt;</code> allow to specify image extension
for exporting dataset (by default <code>.png</code>).</li>
</ul>
<p>These commands also work for MNIST in CSV if you use <code>mnist_csv</code> instead of <code>mnist</code>.</p>
<h2 id="examples">Examples</h2>
<p>Datumaro supports filtering, transformation, merging etc. for all formats
and for the MNIST format in particular. Follow <a href="../../../docs/user-manual/">user manual</a>
to get more information about these operations.</p>
<p>There are few examples of using Datumaro operations to solve
particular problems with MNIST dataset:</p>
<h3 id="example-1-how-to-create-custom-mnist-like-dataset">Example 1. How to create custom MNIST-like dataset</h3>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">from</span> <span style="color:#000">datumaro.components.dataset</span> <span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">Dataset</span>
<span style="color:#204a87;font-weight:bold">from</span> <span style="color:#000">datumaro.components.extractor</span> <span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">Label</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">DatasetItem</span>

<span style="color:#000">dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">from_iterable</span><span style="color:#000;font-weight:bold">([</span>
    <span style="color:#000">DatasetItem</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">id</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">image</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">np</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">ones</span><span style="color:#000;font-weight:bold">((</span><span style="color:#0000cf;font-weight:bold">28</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">28</span><span style="color:#000;font-weight:bold">)),</span>
        <span style="color:#000">annotations</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">Label</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">)]</span>
    <span style="color:#000;font-weight:bold">),</span>
    <span style="color:#000">DatasetItem</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">id</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">image</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">np</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">ones</span><span style="color:#000;font-weight:bold">((</span><span style="color:#0000cf;font-weight:bold">28</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">28</span><span style="color:#000;font-weight:bold">)),</span>
        <span style="color:#000">annotations</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">Label</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">7</span><span style="color:#000;font-weight:bold">)]</span>
    <span style="color:#000;font-weight:bold">)</span>
<span style="color:#000;font-weight:bold">],</span> <span style="color:#000">categories</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">[</span><span style="color:#204a87">str</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">label</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">label</span> <span style="color:#204a87;font-weight:bold">in</span> <span style="color:#204a87">range</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">10</span><span style="color:#000;font-weight:bold">)])</span>

<span style="color:#000">dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">export</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;./dataset&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">format</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;mnist&#39;</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><h3 id="example-2-how-to-filter-and-convert-mnist-dataset-to-imagenet">Example 2. How to filter and convert MNIST dataset to ImageNet</h3>
<p>Convert MNIST dataset to ImageNet format, keep only images with <code>3</code> class
presented:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#8f5902;font-style:italic"># Download MNIST dataset:</span>
<span style="color:#8f5902;font-style:italic"># https://ossci-datasets.s3.amazonaws.com/mnist/train-images-idx3-ubyte.gz</span>
<span style="color:#8f5902;font-style:italic"># https://ossci-datasets.s3.amazonaws.com/mnist/train-labels-idx1-ubyte.gz</span>
datum convert --input-format mnist --input-path &lt;path/to/mnist&gt; <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>              --output-format imagenet <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>              --filter <span style="color:#4e9a06">&#39;/item[annotation/label=&#34;3&#34;]&#39;</span>
</code></pre></div><p>Examples of using this format from the code can be found in
the <a href="https://github.com/openvinotoolkit/datumaro/tree/develop/tests/test_mnist_format.py">binary format tests</a> and <a href="https://github.com/openvinotoolkit/datumaro/tree/develop/tests/test_mnist_csv_format.py">csv format tests</a></p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-f97053c70a29d6713d3412af07bcdcca">10 - Open Images</h1>
    
	<h2 id="format-specification">Format specification</h2>
<p>A description of the Open Images Dataset (OID) format is available
on <a href="https://storage.googleapis.com/openimages/web/download.html">its website</a>.
Datumaro supports versions 4, 5 and 6.</p>
<p>Supported annotation types:</p>
<ul>
<li><code>Label</code> (human-verified image-level labels)</li>
<li><code>Bbox</code> (bounding boxes)</li>
<li><code>Mask</code> (segmentation masks)</li>
</ul>
<p>Supported annotation attributes:</p>
<ul>
<li>
<p>Labels</p>
<ul>
<li><code>score</code> (read/write, float).
The confidence level from 0 to 1.
A score of 0 indicates that
the image does not contain objects of the corresponding class.</li>
</ul>
</li>
<li>
<p>Bounding boxes</p>
<ul>
<li><code>score</code> (read/write, float).
The confidence level from 0 to 1.
In the original dataset this is always equal to 1,
but custom datasets may be created with arbitrary values.</li>
<li><code>occluded</code> (read/write, boolean).
Whether the object is occluded by another object.</li>
<li><code>truncated</code> (read/write, boolean).
Whether the object extends beyond the boundary of the image.</li>
<li><code>is_group_of</code> (read/write, boolean).
Whether the object represents a group of objects of the same class.</li>
<li><code>is_depiction</code> (read/write, boolean).
Whether the object is a depiction (such as a drawing)
rather than a real object.</li>
<li><code>is_inside</code> (read/write, boolean).
Whether the object is seen from the inside.</li>
</ul>
</li>
<li>
<p>Masks</p>
<ul>
<li><code>box_id</code> (read/write, string).
An identifier for the bounding box associated with the mask.</li>
<li><code>predicted_iou</code> (read/write, float).
Predicted IoU value with respect to the ground truth.</li>
</ul>
</li>
</ul>
<h2 id="load-open-images-dataset">Load Open Images dataset</h2>
<p>The Open Images dataset is available for free download.</p>
<p>See the <a href="https://github.com/cvdfoundation/open-images-dataset"><code>open-images-dataset</code> GitHub repository</a>
for information on how to download the images.</p>
<p>Datumaro also requires the image description files,
which can be downloaded from the following URLs:</p>
<ul>
<li><a href="https://storage.googleapis.com/openimages/2018_04/image_ids_and_rotation.csv">complete set</a></li>
<li><a href="https://storage.googleapis.com/openimages/v6/oidv6-train-images-with-labels-with-rotation.csv">train set</a></li>
<li><a href="https://storage.googleapis.com/openimages/2018_04/validation/validation-images-with-rotation.csv">validation set</a></li>
<li><a href="https://storage.googleapis.com/openimages/2018_04/test/test-images-with-rotation.csv">test set</a></li>
</ul>
<p>Datumaro expects at least one of the files above to be present.</p>
<p>In addition, the following metadata file must be present as well:</p>
<ul>
<li><a href="https://storage.googleapis.com/openimages/v6/oidv6-class-descriptions.csv">class descriptions</a></li>
</ul>
<p>You can optionally download the following additional metadata file:</p>
<ul>
<li><a href="https://storage.googleapis.com/openimages/2018_04/bbox_labels_600_hierarchy.json">class hierarchy</a></li>
</ul>
<p>Annotations can be downloaded from the following URLs:</p>
<ul>
<li><a href="https://storage.googleapis.com/openimages/v6/oidv6-train-annotations-human-imagelabels.csv">train image labels</a></li>
<li><a href="https://storage.googleapis.com/openimages/v5/validation-annotations-human-imagelabels.csv">validation image labels</a></li>
<li><a href="https://storage.googleapis.com/openimages/v5/test-annotations-human-imagelabels.csv">test image labels</a></li>
<li><a href="https://storage.googleapis.com/openimages/v6/oidv6-train-annotations-bbox.csv">train bounding boxes</a></li>
<li><a href="https://storage.googleapis.com/openimages/v5/validation-annotations-bbox.csv">validation bounding boxes</a></li>
<li><a href="https://storage.googleapis.com/openimages/v5/test-annotations-bbox.csv">test bounding boxes</a></li>
<li><a href="https://storage.googleapis.com/openimages/v5/train-annotations-object-segmentation.csv">train segmentation masks (metadata)</a></li>
<li>train segmentation masks (images):
<a href="https://storage.googleapis.com/openimages/v5/train-masks/train-masks-0.zip">0</a>
<a href="https://storage.googleapis.com/openimages/v5/train-masks/train-masks-1.zip">1</a>
<a href="https://storage.googleapis.com/openimages/v5/train-masks/train-masks-2.zip">2</a>
<a href="https://storage.googleapis.com/openimages/v5/train-masks/train-masks-3.zip">3</a>
<a href="https://storage.googleapis.com/openimages/v5/train-masks/train-masks-4.zip">4</a>
<a href="https://storage.googleapis.com/openimages/v5/train-masks/train-masks-5.zip">5</a>
<a href="https://storage.googleapis.com/openimages/v5/train-masks/train-masks-6.zip">6</a>
<a href="https://storage.googleapis.com/openimages/v5/train-masks/train-masks-7.zip">7</a>
<a href="https://storage.googleapis.com/openimages/v5/train-masks/train-masks-8.zip">8</a>
<a href="https://storage.googleapis.com/openimages/v5/train-masks/train-masks-9.zip">9</a>
<a href="https://storage.googleapis.com/openimages/v5/train-masks/train-masks-a.zip">a</a>
<a href="https://storage.googleapis.com/openimages/v5/train-masks/train-masks-b.zip">b</a>
<a href="https://storage.googleapis.com/openimages/v5/train-masks/train-masks-c.zip">c</a>
<a href="https://storage.googleapis.com/openimages/v5/train-masks/train-masks-d.zip">d</a>
<a href="https://storage.googleapis.com/openimages/v5/train-masks/train-masks-e.zip">e</a>
<a href="https://storage.googleapis.com/openimages/v5/train-masks/train-masks-f.zip">f</a></li>
<li><a href="https://storage.googleapis.com/openimages/v5/validation-annotations-object-segmentation.csv">validation segmentation masks (metadata)</a></li>
<li>validation segmentation masks (images):
<a href="https://storage.googleapis.com/openimages/v5/validation-masks/validation-masks-0.zip">0</a>
<a href="https://storage.googleapis.com/openimages/v5/validation-masks/validation-masks-1.zip">1</a>
<a href="https://storage.googleapis.com/openimages/v5/validation-masks/validation-masks-2.zip">2</a>
<a href="https://storage.googleapis.com/openimages/v5/validation-masks/validation-masks-3.zip">3</a>
<a href="https://storage.googleapis.com/openimages/v5/validation-masks/validation-masks-4.zip">4</a>
<a href="https://storage.googleapis.com/openimages/v5/validation-masks/validation-masks-5.zip">5</a>
<a href="https://storage.googleapis.com/openimages/v5/validation-masks/validation-masks-6.zip">6</a>
<a href="https://storage.googleapis.com/openimages/v5/validation-masks/validation-masks-7.zip">7</a>
<a href="https://storage.googleapis.com/openimages/v5/validation-masks/validation-masks-8.zip">8</a>
<a href="https://storage.googleapis.com/openimages/v5/validation-masks/validation-masks-9.zip">9</a>
<a href="https://storage.googleapis.com/openimages/v5/validation-masks/validation-masks-a.zip">a</a>
<a href="https://storage.googleapis.com/openimages/v5/validation-masks/validation-masks-b.zip">b</a>
<a href="https://storage.googleapis.com/openimages/v5/validation-masks/validation-masks-c.zip">c</a>
<a href="https://storage.googleapis.com/openimages/v5/validation-masks/validation-masks-d.zip">d</a>
<a href="https://storage.googleapis.com/openimages/v5/validation-masks/validation-masks-e.zip">e</a>
<a href="https://storage.googleapis.com/openimages/v5/validation-masks/validation-masks-f.zip">f</a></li>
<li><a href="https://storage.googleapis.com/openimages/v5/test-annotations-object-segmentation.csv">test segmentation masks (metadata)</a></li>
<li>test segmentation masks (images):
<a href="https://storage.googleapis.com/openimages/v5/test-masks/test-masks-0.zip">0</a>
<a href="https://storage.googleapis.com/openimages/v5/test-masks/test-masks-1.zip">1</a>
<a href="https://storage.googleapis.com/openimages/v5/test-masks/test-masks-2.zip">2</a>
<a href="https://storage.googleapis.com/openimages/v5/test-masks/test-masks-3.zip">3</a>
<a href="https://storage.googleapis.com/openimages/v5/test-masks/test-masks-4.zip">4</a>
<a href="https://storage.googleapis.com/openimages/v5/test-masks/test-masks-5.zip">5</a>
<a href="https://storage.googleapis.com/openimages/v5/test-masks/test-masks-6.zip">6</a>
<a href="https://storage.googleapis.com/openimages/v5/test-masks/test-masks-7.zip">7</a>
<a href="https://storage.googleapis.com/openimages/v5/test-masks/test-masks-8.zip">8</a>
<a href="https://storage.googleapis.com/openimages/v5/test-masks/test-masks-9.zip">9</a>
<a href="https://storage.googleapis.com/openimages/v5/test-masks/test-masks-a.zip">a</a>
<a href="https://storage.googleapis.com/openimages/v5/test-masks/test-masks-b.zip">b</a>
<a href="https://storage.googleapis.com/openimages/v5/test-masks/test-masks-c.zip">c</a>
<a href="https://storage.googleapis.com/openimages/v5/test-masks/test-masks-d.zip">d</a>
<a href="https://storage.googleapis.com/openimages/v5/test-masks/test-masks-e.zip">e</a>
<a href="https://storage.googleapis.com/openimages/v5/test-masks/test-masks-f.zip">f</a></li>
</ul>
<p>All annotation files are optional,
except that if the mask metadata files for a given subset are downloaded,
all corresponding images must be downloaded as well, and vice versa.</p>
<p>There are two ways to create Datumaro project and add OID to it:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum import --format open_images --input-path &lt;path/to/dataset&gt;
<span style="color:#8f5902;font-style:italic"># or</span>
datum create
datum add path -f open_images &lt;path/to/dataset&gt;
</code></pre></div><p>It is possible to specify project name and project directory; run
<code>datum create --help</code> for more information.</p>
<p>Open Images dataset directory should have the following structure:</p>
<pre><code>└─ Dataset/
    ├── annotations/
    │   └── bbox_labels_600_hierarchy.json
    │   └── image_ids_and_rotation.csv
    │   └── oidv6-class-descriptions.csv
    │   └── *-annotations-bbox.csv
    │   └── *-annotations-human-imagelabels.csv
    │   └── *-annotations-object-segmentation.csv
    ├── images/
    |   ├── test/
    |   │   ├── &lt;image_name1.jpg&gt;
    |   │   ├── &lt;image_name2.jpg&gt;
    |   │   └── ...
    |   ├── train/
    |   │   ├── &lt;image_name1.jpg&gt;
    |   │   ├── &lt;image_name2.jpg&gt;
    |   │   └── ...
    |   └── validation/
    |       ├── &lt;image_name1.jpg&gt;
    |       ├── &lt;image_name2.jpg&gt;
    |       └── ...
    └── masks/
        ├── test/
        │   ├── &lt;mask_name1.png&gt;
        │   ├── &lt;mask_name2.png&gt;
        │   └── ...
        ├── train/
        │   ├── &lt;mask_name1.png&gt;
        │   ├── &lt;mask_name2.png&gt;
        │   └── ...
        └── validation/
            ├── &lt;mask_name1.png&gt;
            ├── &lt;mask_name2.png&gt;
            └── ...
</code></pre><p>The mask images must be extracted from the ZIP archives linked above.</p>
<p>To use per-subset image description files instead of <code>image_ids_and_rotation.csv</code>,
place them in the <code>annotations</code> subdirectory.</p>
<h3 id="creating-an-image-metadata-file">Creating an image metadata file</h3>
<p>To load bounding box and segmentation mask annotations,
Datumaro needs to know the sizes of the corresponding images.
By default, it will determine these sizes by loading each image from disk,
which requires the images to be present and makes the loading process slow.</p>
<p>If you want to load the aforementioned annotations on a machine where
the images are not available,
or just to speed up the dataset loading process,
you can extract the image size information in advance
and record it in an image metadata file.
This file must be placed at <code>annotations/images.meta</code>,
and must contain one line per image, with the following structure:</p>
<pre><code>&lt;ID&gt; &lt;height&gt; &lt;width&gt;
</code></pre><p>Where <code>&lt;ID&gt;</code> is the file name of the image without the extension,
and <code>&lt;height&gt;</code> and <code>&lt;width&gt;</code> are the dimensions of that image.
<code>&lt;ID&gt;</code> may be quoted with either single or double quotes.</p>
<p>The image metadata file, if present, will be used to determine the image
sizes without loading the images themselves.</p>
<p>Here&rsquo;s one way to create the <code>images.meta</code> file using ImageMagick,
assuming that the images are present on the current machine:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#8f5902;font-style:italic"># run this from the dataset directory</span>
find images -name <span style="color:#4e9a06">&#39;*.jpg&#39;</span> -exec <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    identify -format <span style="color:#4e9a06">&#39;&#34;%[basename]&#34; %[height] %[width]\n&#39;</span> <span style="color:#ce5c00;font-weight:bold">{}</span> + <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    &gt; annotations/images.meta
</code></pre></div><h2 id="export-to-other-formats">Export to other formats</h2>
<p>Datumaro can convert OID into any other format <a href="../../../docs/user-manual/supported-formats">Datumaro supports</a>.
To get the expected result, convert the dataset to a format
that supports image-level labels.
There are a few ways to convert OID to other dataset format:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum project import -f open_images -i &lt;path/to/open_images&gt;
datum <span style="color:#204a87">export</span> -f cvat -o &lt;path/to/output/dir&gt;
<span style="color:#8f5902;font-style:italic"># or</span>
datum convert -if open_images -i &lt;path/to/open_images&gt; -f cvat -o &lt;path/to/output/dir&gt;
</code></pre></div><p>Some formats provide extra options for conversion.
These options are passed after double dash (<code>--</code>) in the command line.
To get information about them, run</p>
<p><code>datum export -f &lt;FORMAT&gt; -- -h</code></p>
<h2 id="export-to-open-images">Export to Open Images</h2>
<p>There are few ways to convert an existing dataset to the Open Images format:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#8f5902;font-style:italic"># export dataset into Open Images format from existing project</span>
datum <span style="color:#204a87">export</span> -p &lt;path/to/project&gt; -f open_images -o &lt;path/to/export/dir&gt; <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>  -- --save_images

<span style="color:#8f5902;font-style:italic"># convert a dataset in another format to the Open Images format</span>
datum convert -if imagenet -i &lt;path/to/imagenet/dataset&gt; <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    -f open_images -o &lt;path/to/export/dir&gt; <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    -- --save-images
</code></pre></div><p>Extra options for export to the Open Images format:</p>
<ul>
<li>
<p><code>--save-images</code> - save image files when exporting the dataset
(by default, <code>False</code>)</p>
</li>
<li>
<p><code>--image-ext IMAGE_EXT</code> - save image files with the specified extension
when exporting the dataset (by default, uses the original extension
or <code>.jpg</code> if there isn&rsquo;t one)</p>
</li>
</ul>
<h2 id="examples">Examples</h2>
<p>Datumaro supports filtering, transformation, merging etc. for all formats
and for the Open Images format in particular. Follow
<a href="../../../docs/user-manual/">user manual</a>
to get more information about these operations.</p>
<p>Here are a few examples of using Datumaro operations to solve
particular problems with the Open Images dataset:</p>
<h3 id="example-1-load-the-open-images-dataset-and-convert-to-the-cvat-format">Example 1. Load the Open Images dataset and convert to the CVAT format</h3>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create -o project
datum add path -p project -f open_images ./open-images-dataset/
datum stats -p project
datum <span style="color:#204a87">export</span> -p project -o dataset -f cvat --overwrite -- --save-images
</code></pre></div><h3 id="example-2-create-a-custom-oid-like-dataset">Example 2. Create a custom OID-like dataset</h3>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">numpy</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">np</span>
<span style="color:#204a87;font-weight:bold">from</span> <span style="color:#000">datumaro.components.dataset</span> <span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">Dataset</span>
<span style="color:#204a87;font-weight:bold">from</span> <span style="color:#000">datumaro.components.extractor</span> <span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000;font-weight:bold">(</span>
    <span style="color:#000">AnnotationType</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">Label</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">LabelCategories</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">DatasetItem</span><span style="color:#000;font-weight:bold">,</span>
<span style="color:#000;font-weight:bold">)</span>

<span style="color:#000">dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">from_iterable</span><span style="color:#000;font-weight:bold">(</span>
    <span style="color:#000;font-weight:bold">[</span>
        <span style="color:#000">DatasetItem</span><span style="color:#000;font-weight:bold">(</span>
            <span style="color:#204a87">id</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;0000000000000001&#39;</span><span style="color:#000;font-weight:bold">,</span>
            <span style="color:#000">image</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">np</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">ones</span><span style="color:#000;font-weight:bold">((</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">5</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">3</span><span style="color:#000;font-weight:bold">)),</span>
            <span style="color:#000">subset</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;validation&#39;</span><span style="color:#000;font-weight:bold">,</span>
            <span style="color:#000">annotations</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">[</span>
                <span style="color:#000">Label</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">attributes</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">{</span><span style="color:#4e9a06">&#39;score&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">}),</span>
                <span style="color:#000">Label</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">attributes</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">{</span><span style="color:#4e9a06">&#39;score&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">}),</span>
            <span style="color:#000;font-weight:bold">],</span>
        <span style="color:#000;font-weight:bold">),</span>
    <span style="color:#000;font-weight:bold">],</span>
    <span style="color:#000">categories</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;/m/0&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;/m/1&#39;</span><span style="color:#000;font-weight:bold">],</span>
<span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">export</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;./dataset&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">format</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;open_images&#39;</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><p>Examples of using this format from the code can be found in
<a href="https://github.com/openvinotoolkit/datumaro/tree/develop/tests/test_open_images_format.py">the format tests</a>.</p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-db1d30fa5536c19aa2aa75b33dbf92ea">11 - Pascal VOC</h1>
    
	<h2 id="format-specification">Format specification</h2>
<p>Pascal VOC format specification is available
<a href="http://host.robots.ox.ac.uk/pascal/VOC/voc2012/devkit_doc.pdf">here</a>.</p>
<p>The dataset has annotations for multiple tasks. Each task has its own format
in Datumaro, and there is also a combined <code>voc</code> format, which includes all
the available tasks. The sub-formats have the same options as the &ldquo;main&rdquo;
format and only limit the set of annotation files they work with. To work with
multiple formats, use the corresponding option of the <code>voc</code> format.</p>
<p>Supported tasks / formats:</p>
<ul>
<li>The combined format - <code>voc</code></li>
<li>Image classification - <code>voc_classification</code></li>
<li>Object detection - <code>voc_detection</code></li>
<li>Action classification - <code>voc_action</code></li>
<li>Class and instance segmentation - <code>voc_segmentation</code></li>
<li>Person layout detection - <code>voc_layout</code></li>
</ul>
<p>Supported annotation types:</p>
<ul>
<li><code>Label</code> (classification)</li>
<li><code>Bbox</code> (detection, action detection and person layout)</li>
<li><code>Mask</code> (segmentation)</li>
</ul>
<p>Supported annotation attributes:</p>
<ul>
<li><code>occluded</code> (boolean) - indicates that a significant portion of the
object within the bounding box is occluded by another object</li>
<li><code>truncated</code> (boolean) - indicates that the bounding box specified for
the object does not correspond to the full extent of the object</li>
<li><code>difficult</code> (boolean) - indicates that the object is considered difficult
to recognize</li>
<li>action attributes (boolean) - <code>jumping</code>, <code>reading</code> and
<a href="http://host.robots.ox.ac.uk/pascal/VOC/voc2012/actionexamples/index.html">others</a>.
Indicate that the object does the corresponding action.</li>
<li>arbitrary attributes (string/number) - A Datumaro extension. Stored
in the <code>attributes</code> section of the annotation <code>xml</code> file. Available for
bbox annotations only.</li>
</ul>
<h2 id="load-pascal-voc-dataset">Load Pascal VOC dataset</h2>
<p>The Pascal VOC dataset is available for free download
<a href="http://host.robots.ox.ac.uk/pascal/VOC/voc2012/index.html#devkit">here</a></p>
<p>There are two ways to create Datumaro project and add Pascal VOC dataset to it:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum import --format voc --input-path &lt;path/to/dataset&gt;
<span style="color:#8f5902;font-style:italic"># or</span>
datum create
datum add path -f voc &lt;path/to/dataset&gt;
</code></pre></div><p>It is possible to specify project name and project directory run
<code>datum create --help</code> for more information.
Pascal VOC dataset directory should have the following structure:</p>
<!--lint disable fenced-code-flag-->
<pre><code>└─ Dataset/
   ├── label_map.txt # a list of non-Pascal labels (optional)
   │
   ├── Annotations/
   │     ├── ann1.xml # Pascal VOC format annotation file
   │     ├── ann2.xml
   │     └── ...
   ├── JPEGImages/
   │    ├── img1.jpg
   │    ├── img2.jpg
   │    └── ...
   ├── SegmentationClass/ # directory with semantic segmentation masks
   │    ├── img1.png
   │    ├── img2.png
   │    └── ...
   ├── SegmentationObject/ # directory with instance segmentation masks
   │    ├── img1.png
   │    ├── img2.png
   │    └── ...
   │
   └── ImageSets/
        ├── Main/ # directory with list of images for detection and classification task
        │   ├── test.txt  # list of image names in test subset  (without extension)
        |   ├── train.txt # list of image names in train subset (without extension)
        |   └── ...
        ├── Layout/ # directory with list of images for person layout task
        │   ├── test.txt
        |   ├── train.txt
        |   └── ...
        ├── Action/ # directory with list of images for action classification task
        │   ├── test.txt
        |   ├── train.txt
        |   └── ...
        └── Segmentation/ # directory with list of images for segmentation task
            ├── test.txt
            ├── train.txt
            └── ...
</code></pre><p>The <code>ImageSets</code> directory should contain at least one of the directories:
<code>Main</code>, <code>Layout</code>, <code>Action</code>, <code>Segmentation</code>.
These directories contain <code>.txt</code> files with a list of images in a subset,
the subset name is the same as the <code>.txt</code> file name. Subset names can be
arbitrary.</p>
<p>In <code>label_map.txt</code> you can define custom color map and non-pascal labels,
for example:</p>
<pre><code># label_map [label : color_rgb : parts : actions]
helicopter:::
elephant:0:124:134:head,ear,foot:
</code></pre><p>It is also possible to import grayscale (1-channel) PNG masks.
For grayscale masks provide a list of labels with the number of lines
equal to the maximum color index on images. The lines must be in the
right order so that line index is equal to the color index. Lines can
have arbitrary, but different, colors. If there are gaps in the used
color indices in the annotations, they must be filled with arbitrary
dummy labels. Example:</p>
<pre><code>car:0,128,0:: # color index 0
aeroplane:10,10,128:: # color index 1
_dummy2:2,2,2:: # filler for color index 2
_dummy3:3,3,3:: # filler for color index 3
boat:108,0,100:: # color index 3
...
_dummy198:198,198,198:: # filler for color index 198
_dummy199:199,199,199:: # filler for color index 199
the_last_label:12,28,0:: # color index 200
</code></pre><p>You can import dataset for specific tasks
of Pascal VOC dataset instead of the whole dataset,
for example:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum add path -f voc_detection &lt;path/to/dataset/ImageSets/Main/train.txt&gt;
</code></pre></div><p>To make sure that the selected dataset has been added to the project, you
can run <code>datum info</code>, which will display the project and dataset information.</p>
<h2 id="export-to-other-formats">Export to other formats</h2>
<p>Datumaro can convert Pascal VOC dataset into any other format
<a href="../../../docs/user-manual/supported-formats">Datumaro supports</a>.</p>
<p>Such conversion will only be successful if the output
format can represent the type of dataset you want to convert,
e.g. image classification annotations can be
saved in <code>ImageNet</code> format, but no as <code>COCO keypoints</code>.</p>
<p>There are few ways to convert Pascal VOC dataset to other dataset format:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum import -f voc -i &lt;path/to/voc&gt;
datum <span style="color:#204a87">export</span> -f coco -o &lt;path/to/output/dir&gt;
<span style="color:#8f5902;font-style:italic"># or</span>
datum convert -if voc -i &lt;path/to/voc&gt; -f coco -o &lt;path/to/output/dir&gt;

</code></pre></div><p>Some formats provide extra options for conversion.
These options are passed after double dash (<code>--</code>) in the command line.
To get information about them, run</p>
<p><code>datum export -f &lt;FORMAT&gt; -- -h</code></p>
<h2 id="export-to-pascal-voc">Export to Pascal VOC</h2>
<p>There are few ways to convert an existing dataset to Pascal VOC format:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#8f5902;font-style:italic"># export dataset into Pascal VOC format (classification) from existing project</span>
datum <span style="color:#204a87">export</span> -p &lt;path/to/project&gt; -f voc -o &lt;path/to/export/dir&gt; -- --tasks classification

<span style="color:#8f5902;font-style:italic"># converting to Pascal VOC format from other format</span>
datum convert -if imagenet -i &lt;path/to/imagenet/dataset&gt; <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    -f voc -o &lt;path/to/export/dir&gt; <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    -- --label_map voc --save-images
</code></pre></div><p>Extra options for export to Pascal VOC format:</p>
<ul>
<li>
<p><code>--save-images</code> - allow to export dataset with saving images
(by default <code>False</code>)</p>
</li>
<li>
<p><code>--image-ext IMAGE_EXT</code> - allow to specify image extension
for exporting dataset (by default use original or <code>.jpg</code> if none)</p>
</li>
<li>
<p><code>--apply-colormap APPLY_COLORMAP</code> - allow to use colormap for class
and instance masks (by default <code>True</code>)</p>
</li>
<li>
<p><code>--allow-attributes ALLOW_ATTRIBUTES</code> - allow export of attributes
(by default <code>True</code>)</p>
</li>
<li>
<p><code>--keep-empty KEEP_EMPTY</code> - write subset lists even if they are empty
(by default: <code>False</code>)</p>
</li>
<li>
<p><code>--tasks TASKS</code> - allow to specify tasks for export dataset,
by default Datumaro uses all tasks. Example:</p>
</li>
</ul>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum import -o project -f voc -i ./VOC2012
datum <span style="color:#204a87">export</span> -p project -f voc -- --tasks detection,classification
</code></pre></div><ul>
<li><code>--label_map</code> allow to define a custom colormap. Example</li>
</ul>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#8f5902;font-style:italic"># mycolormap.txt [label : color_rgb : parts : actions]:</span>
<span style="color:#8f5902;font-style:italic"># cat:0,0,255::</span>
<span style="color:#8f5902;font-style:italic"># person:255,0,0:head:</span>
datum <span style="color:#204a87">export</span> -f voc_segmentation -- --label-map mycolormap.txt

<span style="color:#8f5902;font-style:italic"># or you can use original voc colomap:</span>
datum <span style="color:#204a87">export</span> -f voc_segmentation -- --label-map voc
</code></pre></div><h2 id="examples">Examples</h2>
<p>Datumaro supports filtering, transformation, merging etc. for all formats
and for the Pascal VOC format in particular. Follow
<a href="../../../docs/user-manual/">user manual</a>
to get more information about these operations.</p>
<p>There are few examples of using Datumaro operations to solve
particular problems with Pascal VOC dataset:</p>
<h3 id="example-1-how-to-prepare-an-original-dataset-for-training">Example 1. How to prepare an original dataset for training.</h3>
<p>In this example, preparing the original dataset to train the semantic
segmentation model includes:
loading,
checking duplicate images,
setting the number of images,
splitting into subsets,
export the result to Pascal VOC format.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create -o project
datum add path -p project -f voc_segmentation ./VOC2012/ImageSets/Segmentation/trainval.txt
datum stats -p project <span style="color:#8f5902;font-style:italic"># check statisctics.json -&gt; repeated images</span>
datum transform -p project -o ndr_project -t ndr -- -w trainval -k <span style="color:#0000cf;font-weight:bold">2500</span>
datum filter -p ndr_project -o trainval2500 -e <span style="color:#4e9a06">&#39;/item[subset=&#34;trainval&#34;]&#39;</span>
datum transform -p trainval2500 -o final_project -t random_split -- -s train:.8 -s val:.2
datum <span style="color:#204a87">export</span> -p final_project -o dataset -f voc -- --label-map voc --save-images
</code></pre></div><h3 id="example-2-how-to-create-custom-dataset">Example 2. How to create custom dataset</h3>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">from</span> <span style="color:#000">datumaro.components.dataset</span> <span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">Dataset</span>
<span style="color:#204a87;font-weight:bold">from</span> <span style="color:#000">datumaro.util.image</span> <span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">Image</span>
<span style="color:#204a87;font-weight:bold">from</span> <span style="color:#000">datumaro.components.extractor</span> <span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">Bbox</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">Polygon</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">Label</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">DatasetItem</span>

<span style="color:#000">dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">from_iterable</span><span style="color:#000;font-weight:bold">([</span>
    <span style="color:#000">DatasetItem</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">id</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;image1&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">image</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">Image</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">path</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;image1.jpg&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">size</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">10</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">20</span><span style="color:#000;font-weight:bold">)),</span>
       <span style="color:#000">annotations</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">Label</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">3</span><span style="color:#000;font-weight:bold">),</span>
           <span style="color:#000">Bbox</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">1.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">1.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">10.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">8.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">label</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">attributes</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">{</span><span style="color:#4e9a06">&#39;difficult&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#3465a4">True</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;running&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#3465a4">True</span><span style="color:#000;font-weight:bold">}),</span>
           <span style="color:#000">Polygon</span><span style="color:#000;font-weight:bold">([</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">3</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">4</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">4</span><span style="color:#000;font-weight:bold">],</span> <span style="color:#000">label</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">attributes</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">{</span><span style="color:#4e9a06">&#39;occluded&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#3465a4">True</span><span style="color:#000;font-weight:bold">}),</span>
           <span style="color:#000">Polygon</span><span style="color:#000;font-weight:bold">([</span><span style="color:#0000cf;font-weight:bold">6</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">7</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">8</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">8</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">9</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">7</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">9</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">6</span><span style="color:#000;font-weight:bold">],</span> <span style="color:#000">label</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">),</span>
        <span style="color:#000;font-weight:bold">]</span>
    <span style="color:#000;font-weight:bold">),</span>
<span style="color:#000;font-weight:bold">],</span> <span style="color:#000">categories</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;person&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;sky&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;water&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;lion&#39;</span><span style="color:#000;font-weight:bold">])</span>

<span style="color:#000">dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">transform</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;polygons_to_masks&#39;</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">export</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;./mydataset&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">format</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;voc&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">label_map</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;my_labelmap.txt&#39;</span><span style="color:#000;font-weight:bold">)</span>

<span style="color:#4e9a06">&#34;&#34;&#34;
</span><span style="color:#4e9a06">my_labelmap.txt:
</span><span style="color:#4e9a06"># label:color_rgb:parts:actions
</span><span style="color:#4e9a06">person:0,0,255:hand,foot:jumping,running
</span><span style="color:#4e9a06">sky:128,0,0::
</span><span style="color:#4e9a06">water:0,128,0::
</span><span style="color:#4e9a06">lion:255,128,0::
</span><span style="color:#4e9a06">&#34;&#34;&#34;</span>
</code></pre></div><h3 id="example-3-load-filter-and-convert-from-code">Example 3. Load, filter and convert from code</h3>
<p>Load Pascal VOC dataset, and export train subset with items
which has <code>jumping</code> attribute:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">from</span> <span style="color:#000">datumaro.components.dataset</span> <span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">Dataset</span>

<span style="color:#000">dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">import_from</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;./VOC2012&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">format</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;voc&#39;</span><span style="color:#000;font-weight:bold">)</span>

<span style="color:#000">train_dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">get_subset</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;train&#39;</span><span style="color:#000;font-weight:bold">)</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">as_dataset</span><span style="color:#000;font-weight:bold">()</span>

<span style="color:#204a87;font-weight:bold">def</span> <span style="color:#000">only_jumping</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">item</span><span style="color:#000;font-weight:bold">):</span>
    <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">ann</span> <span style="color:#204a87;font-weight:bold">in</span> <span style="color:#000">item</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">annotations</span><span style="color:#000;font-weight:bold">:</span>
        <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">ann</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">attributes</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">get</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;jumping&#39;</span><span style="color:#000;font-weight:bold">):</span>
            <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#3465a4">True</span>
    <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#3465a4">False</span>

<span style="color:#000">train_dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">select</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">only_jumping</span><span style="color:#000;font-weight:bold">)</span>

<span style="color:#000">train_dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">export</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;./jumping_label_me&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">format</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;label_me&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">save_images</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#3465a4">True</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><h3 id="example-4-get-information-about-items-in-pascal-voc-2012-dataset-for-segmentation-task">Example 4. Get information about items in Pascal VOC 2012 dataset for segmentation task:</h3>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">from</span> <span style="color:#000">datumaro.components.dataset</span> <span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">Dataset</span>
<span style="color:#204a87;font-weight:bold">from</span> <span style="color:#000">datumaro.components.extractor</span> <span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">AnnotationType</span>

<span style="color:#000">dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">import_from</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;./VOC2012&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">format</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;voc&#39;</span><span style="color:#000;font-weight:bold">)</span>

<span style="color:#204a87;font-weight:bold">def</span> <span style="color:#000">has_mask</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">item</span><span style="color:#000;font-weight:bold">):</span>
    <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">ann</span> <span style="color:#204a87;font-weight:bold">in</span> <span style="color:#000">item</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">annotations</span><span style="color:#000;font-weight:bold">:</span>
        <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">ann</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">type</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#000">AnnotationType</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">mask</span><span style="color:#000;font-weight:bold">:</span>
            <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#3465a4">True</span>
    <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#3465a4">False</span>

<span style="color:#000">dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">select</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">has_mask</span><span style="color:#000;font-weight:bold">)</span>

<span style="color:#204a87;font-weight:bold">print</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Pascal VOC 2012 has </span><span style="color:#4e9a06">%s</span><span style="color:#4e9a06"> images for segmentation task:&#34;</span> <span style="color:#ce5c00;font-weight:bold">%</span> <span style="color:#204a87">len</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">dataset</span><span style="color:#000;font-weight:bold">))</span>
<span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">subset_name</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">subset</span> <span style="color:#204a87;font-weight:bold">in</span> <span style="color:#000">dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">subsets</span><span style="color:#000;font-weight:bold">()</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">items</span><span style="color:#000;font-weight:bold">():</span>
    <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">item</span> <span style="color:#204a87;font-weight:bold">in</span> <span style="color:#000">subset</span><span style="color:#000;font-weight:bold">:</span>
        <span style="color:#204a87;font-weight:bold">print</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">item</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">id</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">subset_name</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">end</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#34;;&#34;</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><p>After executing this code, we can see that there are 5826 images
in Pascal VOC 2012 has for segmentation task and this result is the same as the
<a href="http://host.robots.ox.ac.uk/pascal/VOC/voc2012/dbstats.html">official documentation</a></p>
<p>Examples of using this format from the code can be found in
<a href="https://github.com/openvinotoolkit/datumaro/tree/develop/tests/test_voc_format.py">tests</a></p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-0c9b196a180c68b9b42be11ddc52c8bb">12 - Supervisely Point Cloud</h1>
    
	<h2 id="format-specification">Format specification</h2>
<p>Point Cloud data format:</p>
<ul>
<li><a href="https://docs.supervise.ly/data-organization/00_ann_format_navi">specification</a>.</li>
<li><a href="https://drive.google.com/file/d/1BtZyffWtWNR-mk_PHNPMnGgSlAkkQpBl/view">example</a>.</li>
</ul>
<p>Supported annotation types:</p>
<ul>
<li><code>cuboid_3d</code></li>
</ul>
<p>Supported annotation attributes:</p>
<ul>
<li><code>track_id</code> (read/write, integer), responsible for <code>object</code> field</li>
<li><code>createdAt</code> (write, string),</li>
<li><code>updatedAt</code> (write, string),</li>
<li><code>labelerLogin</code> (write, string), responsible for the corresponding fields
in the annotation file.</li>
<li>arbitrary attributes</li>
</ul>
<p>Supported image attributes:</p>
<ul>
<li><code>description</code> (read/write, string),</li>
<li><code>createdAt</code> (write, string),</li>
<li><code>updatedAt</code> (write, string),</li>
<li><code>labelerLogin</code> (write, string), responsible for the corresponding fields
in the annotation file.</li>
<li><code>frame</code> (read/write, integer). Indicates frame number of the image.</li>
<li>arbitrary attributes</li>
</ul>
<h2 id="import-supervisely-point-cloud-dataset">Import Supervisely Point Cloud dataset</h2>
<p>An example dataset in Supervisely Point Cloud format is available for download:</p>
<p><a href="https://drive.google.com/u/0/uc?id=1BtZyffWtWNR-mk_PHNPMnGgSlAkkQpBl&amp;export=download">https://drive.google.com/u/0/uc?id=1BtZyffWtWNR-mk_PHNPMnGgSlAkkQpBl&amp;export=download</a></p>
<p>Point Cloud dataset directory should have the following structure:</p>
<!--lint disable fenced-code-flag-->
<pre><code>└─ Dataset/
    ├── ds0/
    │   ├── ann/
    │   │   ├── &lt;pcdname1.pcd.json&gt;
    │   │   ├── &lt;pcdname2.pcd.json&gt;
    │   │   └── ...
    │   ├── pointcloud/
    │   │   ├── &lt;pcdname1.pcd&gt;
    │   │   ├── &lt;pcdname1.pcd&gt;
    │   │   └── ...
    │   ├── related_images/
    │   │   ├── &lt;pcdname1_pcd&gt;/
    │   │   |  ├── &lt;image_name.ext.json&gt;
    │   │   |  ├── &lt;image_name.ext.json&gt;
    │   │   └── ...
    ├── key_id_map.json
    └── meta.json
</code></pre><p>There are two ways to import Supervisely Point Cloud dataset:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum import --format sly_pointcloud --input-path &lt;path/to/dataset&gt;
<span style="color:#8f5902;font-style:italic"># or</span>
datum create
datum add path -f sly_pointcloud &lt;path/to/dataset&gt;
</code></pre></div><p>To make sure that the selected dataset has been added to the project,
you can run <code>datum info</code>, which will display the project and dataset
information.</p>
<h2 id="export-to-other-formats">Export to other formats</h2>
<p>Datumaro can convert Supervisely Point Cloud dataset into any other
format <a href="../../../docs/user-manual/supported-formats/">Datumaro supports</a>.</p>
<p>Such conversion will only be successful if the output
format can represent the type of dataset you want to convert,
e.g. 3D point clouds can be saved in KITTI Raw format,
but not in COCO keypoints.</p>
<p>There are few ways to convert Supervisely Point Cloud dataset
to other dataset formats:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum import -f sly_pointcloud -i &lt;path/to/sly_pcd/&gt; -o proj/
datum <span style="color:#204a87">export</span> -f kitti_raw -o &lt;path/to/output/dir&gt; -p proj/
<span style="color:#8f5902;font-style:italic"># or</span>
datum convert -if sly_pointcloud -i &lt;path/to/sly_pcd/&gt; -f kitti_raw
</code></pre></div><p>Some formats provide extra options for conversion.
These options are passed after double dash (<code>--</code>) in the command line.
To get information about them, run</p>
<p><code>datum export -f &lt;FORMAT&gt; -- -h</code></p>
<h2 id="export-to-supervisely-point-cloud">Export to Supervisely Point Cloud</h2>
<p>There are few ways to convert dataset to Supervisely Point Cloud format:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#8f5902;font-style:italic"># export dataset into Supervisely Point Cloud format from existing project</span>
datum <span style="color:#204a87">export</span> -p &lt;path/to/project&gt; -f sly_pointcloud -o &lt;path/to/export/dir&gt; <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    -- --save-images
<span style="color:#8f5902;font-style:italic"># converting to Supervisely Point Cloud format from other format</span>
datum convert -if kitti_raw -i &lt;path/to/kitti_raw/dataset&gt; <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    -f sly_pointcloud -o &lt;path/to/export/dir&gt; -- --save-images
</code></pre></div><p>Extra options for exporting in Supervisely Point Cloud format:</p>
<ul>
<li><code>--save-images</code> allow to export dataset with saving images. This will
include point clouds and related images (by default <code>False</code>)</li>
<li><code>--image-ext IMAGE_EXT</code> allow to specify image extension
for exporting dataset (by default - keep original or use <code>.png</code>, if none)</li>
<li><code>--reindex</code> assigns new indices to frames and annotations.</li>
<li><code>--allow-undeclared-attrs</code> allows writing arbitrary annotation attributes.
By default, only attributes specified in the input dataset metainfo
will be written.</li>
</ul>
<h2 id="examples">Examples</h2>
<h3 id="example-1-import-dataset-compute-statistics">Example 1. Import dataset, compute statistics</h3>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create -o project
datum add path -p project -f sly_pointcloud ../sly_dataset/
datum stats -p project
</code></pre></div><h3 id="example-2-convert-supervisely-point-clouds-to-kitti-raw">Example 2. Convert Supervisely Point Clouds to KITTI Raw</h3>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum convert -if sly_pointcloud -i ../sly_pcd/ <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    -f kitti_raw -o my_kitti/ -- --save-images --reindex --allow-attrs
</code></pre></div><h3 id="example-3-create-a-custom-dataset">Example 3. Create a custom dataset</h3>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">from</span> <span style="color:#000">datumaro.components.dataset</span> <span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">Dataset</span>
<span style="color:#204a87;font-weight:bold">from</span> <span style="color:#000">datumaro.components.extractor</span> <span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">Cuboid3d</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">DatasetItem</span>

<span style="color:#000">dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">from_iterable</span><span style="color:#000;font-weight:bold">([</span>
    <span style="color:#000">DatasetItem</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">id</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;frame_1&#39;</span><span style="color:#000;font-weight:bold">,</span>
        <span style="color:#000">annotations</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">[</span>
            <span style="color:#000">Cuboid3d</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">id</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">206</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">label</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span>
                <span style="color:#000">position</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">320.86</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">979.18</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">1.04</span><span style="color:#000;font-weight:bold">],</span>
                <span style="color:#000">attributes</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">{</span><span style="color:#4e9a06">&#39;occluded&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#3465a4">False</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;track_id&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;x&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">}),</span>

            <span style="color:#000">Cuboid3d</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">id</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">207</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">label</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span>
                <span style="color:#000">position</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">318.19</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">974.65</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">1.29</span><span style="color:#000;font-weight:bold">],</span>
                <span style="color:#000">attributes</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">{</span><span style="color:#4e9a06">&#39;occluded&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#3465a4">True</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;track_id&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">}),</span>
        <span style="color:#000;font-weight:bold">],</span>
        <span style="color:#000">pcd</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;path/to/pcd1.pcd&#39;</span><span style="color:#000;font-weight:bold">,</span>
        <span style="color:#000">attributes</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">{</span><span style="color:#4e9a06">&#39;frame&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;description&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#39;zzz&#39;</span><span style="color:#000;font-weight:bold">}</span>
    <span style="color:#000;font-weight:bold">),</span>

    <span style="color:#000">DatasetItem</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">id</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;frm2&#39;</span><span style="color:#000;font-weight:bold">,</span>
        <span style="color:#000">annotations</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">[</span>
            <span style="color:#000">Cuboid3d</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">id</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">208</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">label</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span>
                <span style="color:#000">position</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">23.04</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">8.75</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">-</span><span style="color:#0000cf;font-weight:bold">0.78</span><span style="color:#000;font-weight:bold">],</span>
                <span style="color:#000">attributes</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">{</span><span style="color:#4e9a06">&#39;occluded&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#3465a4">False</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;track_id&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">})</span>
        <span style="color:#000;font-weight:bold">],</span>
        <span style="color:#000">pcd</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;path/to/pcd2.pcd&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">related_images</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;image2.png&#39;</span><span style="color:#000;font-weight:bold">],</span>
        <span style="color:#000">attributes</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">{</span><span style="color:#4e9a06">&#39;frame&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">}</span>
    <span style="color:#000;font-weight:bold">),</span>
<span style="color:#000;font-weight:bold">],</span> <span style="color:#000">categories</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;cat&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;dog&#39;</span><span style="color:#000;font-weight:bold">])</span>

<span style="color:#000">dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">export</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;my_dataset/&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">format</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;sly_pointcloud&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">save_images</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#3465a4">True</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#000">allow_undeclared_attrs</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#3465a4">True</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><p>Examples of using this format from the code can be found in
<a href="https://github.com/openvinotoolkit/datumaro/tree/develop/tests/test_sly_pointcloud_format.py">the format tests</a></p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-f638f1a110145e49bc81ee72961dd7ef">13 - YOLO</h1>
    
	<h2 id="format-specification">Format specification</h2>
<ul>
<li>
<p>The YOLO dataset format is for training and validating object detection
models. Specification for this format available
<a href="https://github.com/AlexeyAB/darknet#how-to-train-to-detect-your-custom-objects">here</a>.
And also you can find some official examples on working with YOLO dataset
<a href="https://pjreddie.com/darknet/yolo/">here</a>;</p>
</li>
<li>
<p>The YOLO dataset format support the following types of annotations:</p>
<ul>
<li><code>Bounding boxes</code></li>
</ul>
</li>
<li>
<p>YOLO format doesn&rsquo;t support attributes for annotations;</p>
</li>
<li>
<p>The format only supports subsets named <code>train</code> or <code>valid</code>.</p>
</li>
</ul>
<h2 id="load-yolo-dataset">Load YOLO dataset</h2>
<p>Few ways to create Datumaro project and add YOLO dataset to it:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum import -o project -f yolo -i &lt;path/to/yolo/dataset&gt;

<span style="color:#8f5902;font-style:italic"># another way to do the same:</span>
datum create -o project
datum add path -p project -f yolo -i &lt;path/to/yolo/dataset&gt;

<span style="color:#8f5902;font-style:italic"># and you can add another one yolo dataset:</span>
datum add path -p project -f yolo -i &lt;path/to/other/yolo/dataset&gt;
</code></pre></div><p>YOLO dataset directory should have the following structure:</p>
<!--lint disable fenced-code-flag-->
<pre><code>└─ yolo_dataset/
   │
   ├── obj.names  # file with list of classes
   ├── obj.data   # file with dataset information
   ├── train.txt  # list of image paths in train subset
   ├── valid.txt  # list of image paths in valid subset
   │
   ├── obj_train_data/  # directory with annotations and images for train subset
   │    ├── image1.txt  # list of labeled bounding boxes for image1
   │    ├── image1.jpg
   │    ├── image2.txt
   │    ├── image2.jpg
   │    ├── ...
   │
   ├── obj_valid_data/  # directory with annotations and images for valid subset
   │    ├── image101.txt
   │    ├── image101.jpg
   │    ├── image102.txt
   │    ├── image102.jpg
   │    ├── ...
</code></pre><blockquote>
<p>YOLO dataset cannot contain a subset with a name other than <code>train</code> or <code>valid</code>.
If imported dataset contains such subsets, they will be ignored.
If you are exporting a project into yolo format,
all subsets different from <code>train</code> and <code>valid</code> will be skipped.
If there is no subset separation in a project, the data
will be saved in <code>train</code> subset.</p>
</blockquote>
<ul>
<li><code>obj.data</code> should have the following content, it is not necessary to have both
subsets, but necessary to have one of them:</li>
</ul>
<pre><code>classes = 5 # optional
names = &lt;path/to/obj.names&gt;
train = &lt;path/to/train.txt&gt;
valid = &lt;path/to/valid.txt&gt;
backup = backup/ # optional
</code></pre><ul>
<li><code>obj.names</code> contain list of classes.
The line number for the class is the same as its index:</li>
</ul>
<pre><code>label1  # label1 has index 0
label2  # label2 has index 1
label3  # label2 has index 2
...
</code></pre><ul>
<li>Files <code>train.txt</code> and <code>valid.txt</code> should have the following structure:</li>
</ul>
<pre><code>&lt;path/to/image1.jpg&gt;
&lt;path/to/image2.jpg&gt;
...
</code></pre><ul>
<li>Files in directories <code>obj_train_data/</code> and <code>obj_valid_data/</code>
should contain information about labeled bounding boxes
for images:</li>
</ul>
<pre><code># image1.txt:
# &lt;label_index&gt; &lt;x_center&gt; &lt;y_center&gt; &lt;width&gt; &lt;height&gt;
0 0.250000 0.400000 0.300000 0.400000
3 0.600000 0.400000 0.400000 0.266667
</code></pre><p>Here <code>x_center</code>, <code>y_center</code>, <code>width</code>, and <code>height</code> are relative to the image&rsquo;s
width and height. The <code>x_center</code> and <code>y_center</code> are center of rectangle
(are not top-left corner).</p>
<h2 id="export-to-other-formats">Export to other formats</h2>
<p>Datumaro can convert YOLO dataset into any other format
<a href="../../../docs/user-manual/supported-formats/">Datumaro supports</a>.
For successful conversion the output format should support
object detection task (e.g. Pascal VOC, COCO, TF Detection API etc.)</p>
<p>Examples:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum import -o project -f yolo -i &lt;path/to/yolo/dataset&gt;
datum <span style="color:#204a87">export</span> -p project -f voc -o &lt;path/to/output/voc/dataset&gt;
</code></pre></div><div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum convert -if yolo -i &lt;path/to/yolo/dataset&gt; <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>              -f coco_instances -o &lt;path/to/output/coco/dataset&gt;
</code></pre></div><h2 id="export-to-yolo-format">Export to YOLO format</h2>
<p>Datumaro can convert an existing dataset to YOLO format,
if the dataset supports object detection task.</p>
<p>Example:</p>
<pre><code>datum import -p project -f coco_instances -i &lt;path/to/coco/dataset&gt;
datum export -p project -f yolo -o &lt;path/to/output/yolo/dataset&gt; -- --save-images
</code></pre><p>Extra options for export to YOLO format:</p>
<ul>
<li><code>--save-images</code> allow to export dataset with saving images
(default: <code>False</code>);</li>
<li><code>--image-ext &lt;IMAGE_EXT&gt;</code> allow to specify image extension
for exporting dataset (default: use original or <code>.jpg</code>, if none).</li>
</ul>
<h2 id="examples">Examples</h2>
<h3 id="example-1-prepare-pascal-voc-dataset-for-exporting-to-yolo-format-dataset">Example 1. Prepare PASCAL VOC dataset for exporting to YOLO format dataset</h3>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum import -o project -f voc -i ./VOC2012
datum filter -p project -e <span style="color:#4e9a06">&#39;/item[subset=&#34;train&#34; or subset=&#34;val&#34;]&#39;</span> -o trainval_voc
datum transform -p trainval_voc -o trainvalid_voc <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    -t map_subsets -- -s train:train -s val:valid
datum <span style="color:#204a87">export</span> -p trainvalid_voc -f yolo -o ./yolo_dataset -- --save-images
</code></pre></div><h3 id="example-2-remove-some-class-from-yolo-dataset">Example 2. Remove some class from YOLO dataset</h3>
<p>Delete all items, which contain <code>cat</code> objects and remove
<code>cat</code> from list of classes:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum import -o project -f yolo -i ./yolo_dataset
datum filter -p project -o filtered -m i+a -e <span style="color:#4e9a06">&#39;/item/annotation[label!=&#34;cat&#34;]&#39;</span>
datum transform -p filtered -o without_cat -t remap_labels -- -l cat:
datum <span style="color:#204a87">export</span> -p without_cat -f yolo -o ./yolo_without_cats
</code></pre></div><h3 id="example-3-create-custom-dataset-in-yolo-format">Example 3. Create custom dataset in YOLO format</h3>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">numpy</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">np</span>
<span style="color:#204a87;font-weight:bold">from</span> <span style="color:#000">datumaro.components.dataset</span> <span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">Dataset</span>
<span style="color:#204a87;font-weight:bold">from</span> <span style="color:#000">datumaro.components.extractor</span> <span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">Bbox</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">DatasetItem</span>

<span style="color:#000">dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">from_iterable</span><span style="color:#000;font-weight:bold">([</span>
    <span style="color:#000">DatasetItem</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">id</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;image_001&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">subset</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;train&#39;</span><span style="color:#000;font-weight:bold">,</span>
        <span style="color:#000">image</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">np</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">ones</span><span style="color:#000;font-weight:bold">((</span><span style="color:#0000cf;font-weight:bold">20</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">20</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">3</span><span style="color:#000;font-weight:bold">)),</span>
        <span style="color:#000">annotations</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">[</span>
            <span style="color:#000">Bbox</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">3.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">1.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">8.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">5.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">label</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">),</span>
            <span style="color:#000">Bbox</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">1.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">1.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">10.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">1.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">label</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">)</span>
        <span style="color:#000;font-weight:bold">]</span>
    <span style="color:#000;font-weight:bold">),</span>
    <span style="color:#000">DatasetItem</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">id</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;image_002&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">subset</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;train&#39;</span><span style="color:#000;font-weight:bold">,</span>
        <span style="color:#000">image</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">np</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">ones</span><span style="color:#000;font-weight:bold">((</span><span style="color:#0000cf;font-weight:bold">15</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">10</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">3</span><span style="color:#000;font-weight:bold">)),</span>
        <span style="color:#000">annotations</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">[</span>
            <span style="color:#000">Bbox</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">4.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">4.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">4.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">4.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">label</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">3</span><span style="color:#000;font-weight:bold">)</span>
        <span style="color:#000;font-weight:bold">]</span>
    <span style="color:#000;font-weight:bold">)</span>
<span style="color:#000;font-weight:bold">],</span> <span style="color:#000">categories</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;house&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;bridge&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;crosswalk&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;traffic_light&#39;</span><span style="color:#000;font-weight:bold">])</span>

<span style="color:#000">dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">export</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;../yolo_dataset&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">format</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;yolo&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">save_images</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#3465a4">True</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><h3 id="example-4-get-information-about-objects-on-each-image">Example 4. Get information about objects on each image</h3>
<p>If you only want information about label names for each
images, then you can get it from code:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">from</span> <span style="color:#000">datumaro.components.dataset</span> <span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">Dataset</span>
<span style="color:#204a87;font-weight:bold">from</span> <span style="color:#000">datumaro.components.extractor</span> <span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">AnnotationType</span>

<span style="color:#000">dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">import_from</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;./yolo_dataset&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">format</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;yolo&#39;</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">cats</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">categories</span><span style="color:#000;font-weight:bold">()[</span><span style="color:#000">AnnotationType</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">label</span><span style="color:#000;font-weight:bold">]</span>

<span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">item</span> <span style="color:#204a87;font-weight:bold">in</span> <span style="color:#000">dataset</span><span style="color:#000;font-weight:bold">:</span>
    <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">ann</span> <span style="color:#204a87;font-weight:bold">in</span> <span style="color:#000">item</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">annotations</span><span style="color:#000;font-weight:bold">:</span>
        <span style="color:#204a87;font-weight:bold">print</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">item</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">id</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">cats</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">ann</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">label</span><span style="color:#000;font-weight:bold">]</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">name</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><p>And If you want complete information about each items you can run:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum import -o project -f yolo -i ./yolo_dataset
datum filter -p project --dry-run -e <span style="color:#4e9a06">&#39;/item&#39;</span>
</code></pre></div>
</div>



    
	
  



          </main>
        </div>
      </div>
      
<footer class="bg-dark py-5 row d-print-none">
  <div class="container-fluid mx-sm-5">
    <div class="row">
      <div class="col-6 col-sm-2 text-xs-center order-sm-2">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="" aria-label="">
    <a class="text-white" rel="noopener noreferrer" href="">
      <i class=""></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-6 col-sm-2 text-right text-xs-center order-sm-3">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="GitHub" aria-label="GitHub">
    <a class="text-white" rel="noopener noreferrer" href="https://github.com/openvinotoolkit/datumaro">
      <i class="fab fa-github"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-12 col-sm-8 text-center order-sm-2">
        <small class="mr-1"><a href="https://www.intel.com/content/www/us/en/privacy/intel-privacy-notice.html">Privacy Policy</a></small>
        |
        <small class="mx-1"><a href="https://www.intel.com/content/www/us/en/legal/terms-of-use.html">Terms of Use</a></small>
        <br/>
        <div class="footer-disclaimer text-white ">
          <small>Intel technologies may require enabled hardware, software or service activation. // No product or component can be absolutely secure. // Your costs and results may vary. // Performance varies by use, configuration and other factors. // See our complete legal <u><a href="https://edc.intel.com/content/www/us/en/products/performance/benchmarks/overview/?r=219444055">Notices and Disclaimers</a></u>. // Intel is committed to respecting human rights and avoiding complicity in human rights abuses. See Intel’s <a href="https://www.intel.com/content/www/us/en/policy/policy-human-rights.html"><u>Global Human Rights Principles</u></a>. Intel’s products and software are intended only to be used in applications that do not cause or contribute to a violation of an internationally recognized human right.</small>
        </div>
        
      </div>
    </div>
  </div>
</footer>


    </div>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js" integrity="sha384-+YQ4JLhjyBLPDQt//I+STsc9iw4uQqACwlvpslubQzn4u2UU2UFM80nGisd026JF" crossorigin="anonymous"></script>


<script src="https://cdn.jsdelivr.net/npm/mermaid@8.9.2/dist/mermaid.min.js" integrity="sha384-uQikAXnCAqsMb3ygtdqBYvcwvHUkzGIpjdGyy9owhURXHUxLC5LgTcSxJQH/RzjK" crossorigin="anonymous"></script>





 













<script src="../../../js/main.min.ee00f42d1b949caa55ccf416202998d65afac8f58091e2719c89d4fc3518550e.js" integrity="sha256-7gD0LRuUnKpVzPQWICmY1lr6yPWAkeJxnInU/DUYVQ4=" crossorigin="anonymous"></script>



<script src='../../../js/prism.js'></script>



  </body>
</html>
